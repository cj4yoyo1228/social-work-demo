<!doctype html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>æ°¸çºŒå¿—å·¥ï¼šé˜¿æ˜çš„æˆé•·æ•¸æ“šé£›è¼ª</title>

    <!-- Google Fontsï¼šè¼‰å…¥ Interï¼ˆæ•¸å­—/è‹±æ–‡ï¼‰+ Noto Sans TCï¼ˆä¸­æ–‡ï¼‰å­—å‹ -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;900&family=Noto+Sans+TC:wght@300;400;500;700;900&display=swap"
      rel="stylesheet"
    />

    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- React 18 CDN -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

    <!-- Babel Standaloneï¼šè®“ç€è¦½å™¨èƒ½ç›´æ¥è·‘ JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Tailwind è‡ªè¨‚è¨­å®šï¼šå­—å‹æ”¹ç”¨ Noto Sans TC -->
    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: {
              sans: ['"Noto Sans TC"', "sans-serif"],
            },
          },
        },
      };
    </script>

    <style>
      /* === é é¢åŸºç¤æ¨£å¼ === */
      body {
        margin: 0;
        padding: 0;
        background: #f0faf9;
        font-family: "Noto Sans TC", sans-serif;
      }

      /* === Inter å­—é«”ç”¨æ–¼æ•¸å­—ã€ç™¾åˆ†æ¯”ã€é€²åº¦æ•¸å€¼ === */
      .font-inter {
        font-family: "Inter", "Noto Sans TC", sans-serif;
      }

      /* === CSS Keyframes å‹•ç•«å®šç¾© === */

      /* æ·¡å…¥ */
      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }

      /* å¾ä¸‹æ–¹æ·¡å…¥ä¸Šæ»‘ */
      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(24px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* å¾å³å´æ»‘å…¥ */
      @keyframes slideInRight {
        from {
          opacity: 0;
          transform: translateX(40px);
        }
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }

      /* è„ˆè¡é–ƒçˆï¼ˆç”¨æ–¼ç•¶å‰é€²åº¦åœ“é»ï¼‰ */
      @keyframes pulse {
        0%,
        100% {
          box-shadow: 0 0 0 0 rgba(0, 137, 123, 0.5);
        }
        50% {
          box-shadow: 0 0 0 8px rgba(0, 137, 123, 0);
        }
      }

      /* ç¸®æ”¾å½ˆå…¥ */
      @keyframes scaleIn {
        from {
          opacity: 0;
          transform: scale(0.8);
        }
        to {
          opacity: 1;
          transform: scale(1);
        }
      }

      /* é€²åº¦æ¢å¡«å……å‹•ç•« */
      @keyframes progressBar {
        from {
          width: 0%;
        }
        to {
          width: 100%;
        }
      }

      /* é›·é”åœ–ç¶»æ”¾å‹•ç•« */
      @keyframes radarBloom {
        from {
          opacity: 0;
          transform: scale(0.3) rotate(-10deg);
        }
        to {
          opacity: 1;
          transform: scale(1) rotate(0deg);
        }
      }

      /* === å‹•ç•«å·¥å…· class === */
      .animate-fade-in {
        animation: fadeIn 0.5s ease-out forwards;
      }

      .animate-fade-in-up {
        animation: fadeInUp 0.7s cubic-bezier(0.22, 1, 0.36, 1) forwards;
        opacity: 0;
      }

      .animate-slide-in-right {
        animation: slideInRight 0.6s cubic-bezier(0.22, 1, 0.36, 1) forwards;
        opacity: 0;
      }

      .animate-pulse-dot {
        animation: pulse 2s ease-in-out infinite;
      }

      .animate-scale-in {
        animation: scaleIn 0.5s cubic-bezier(0.22, 1, 0.36, 1) forwards;
        opacity: 0;
      }

      .animate-progress-bar {
        animation: progressBar 1.2s ease-out forwards;
      }

      .animate-radar-bloom {
        animation: radarBloom 0.8s cubic-bezier(0.22, 1, 0.36, 1) forwards;
        opacity: 0;
      }

      /* === å½ˆè·³åœ“é»å‹•ç•«ï¼ˆAI è½‰è­¯ä¸­ä½¿ç”¨ï¼‰ === */
      @keyframes bounceDot {
        0%,
        80%,
        100% {
          transform: translateY(0);
        }
        40% {
          transform: translateY(-8px);
        }
      }

      .bouncing-dots {
        display: inline-flex;
        gap: 4px;
        align-items: center;
        margin-left: 4px;
      }

      .bouncing-dots span {
        width: 6px;
        height: 6px;
        border-radius: 50%;
        background-color: #00897b;
        display: inline-block;
        animation: bounceDot 1.2s ease-in-out infinite;
      }

      .bouncing-dots span:nth-child(2) {
        animation-delay: 0.15s;
      }

      .bouncing-dots span:nth-child(3) {
        animation-delay: 0.3s;
      }

      /* === å°è©±æ³¡æ³¡å°¾å·´ === */
      .chat-bubble-left::before {
        content: "";
        position: absolute;
        left: -6px;
        top: 12px;
        width: 0;
        height: 0;
        border-top: 6px solid transparent;
        border-bottom: 6px solid transparent;
        border-right: 6px solid #00897b;
      }

      .chat-bubble-right::before {
        content: "";
        position: absolute;
        right: -6px;
        top: 12px;
        width: 0;
        height: 0;
        border-top: 6px solid transparent;
        border-bottom: 6px solid transparent;
        border-left: 6px solid #f97316;
      }

      /* === Toast æ·¡å…¥æ·¡å‡ºå‹•ç•« === */
      @keyframes toastFadeIn {
        from {
          opacity: 0;
          transform: translate(-50%, 20px);
        }
        to {
          opacity: 1;
          transform: translate(-50%, 0);
        }
      }

      @keyframes toastFadeOut {
        from {
          opacity: 1;
          transform: translate(-50%, 0);
        }
        to {
          opacity: 0;
          transform: translate(-50%, 20px);
        }
      }

      .toast-enter {
        animation: toastFadeIn 0.3s ease-out forwards;
      }

      .toast-exit {
        animation: toastFadeOut 0.3s ease-out forwards;
      }

      /* === ç”Ÿæˆé€²åº¦æ¢å‹•ç•« === */
      .animate-generating-progress {
        animation: progressBar 3s linear forwards;
      }

      /* === è­‰æ›¸è§’è½è£é£¾ === */
      .certificate-frame {
        position: relative;
      }

      .certificate-frame::before,
      .certificate-frame::after {
        content: "âœ¦";
        position: absolute;
        font-size: 18px;
        color: #d97706;
        opacity: 0.6;
      }

      .certificate-frame::before {
        top: 12px;
        left: 16px;
      }

      .certificate-frame::after {
        top: 12px;
        right: 16px;
      }

      .certificate-corner-bl,
      .certificate-corner-br {
        position: absolute;
        font-size: 18px;
        color: #d97706;
        opacity: 0.6;
      }

      .certificate-corner-bl {
        bottom: 12px;
        left: 16px;
      }

      .certificate-corner-br {
        bottom: 12px;
        right: 16px;
      }

      /* === éšæ®µè½‰å ´æ•ˆæœ === */
      .stage-enter {
        animation: fadeInUp 0.5s cubic-bezier(0.22, 1, 0.36, 1) forwards;
      }

      .stage-exit {
        opacity: 0;
        transition: opacity 0.3s ease-out;
      }
    </style>
  </head>

  <body>
    <!-- React æ›è¼‰é» -->
    <div id="root"></div>

    <script type="text/babel">
      /* ==========================================
       *  æ°¸çºŒå¿—å·¥ï¼šé˜¿æ˜çš„æˆé•·æ•¸æ“šé£›è¼ª
       *  React 18 + Tailwind CSS + Babel Standalone
       * ========================================== */

      const { useState, useCallback, useEffect, useRef } = React;

      /* ------------------------------------------
       * é¡è‰²å¸¸æ•¸ï¼ˆè‰²å½©ä»£ç¢¼é›†ä¸­ç®¡ç†ï¼‰
       * ------------------------------------------ */
      const COLORS = {
        brandDeep: "#00695C", // å“ç‰Œé’ç¶ ï¼ˆæ·±è‰²ï¼‰
        brandBright: "#00897B", // å“ç‰Œé’ç¶ ï¼ˆäº®è‰²ï¼‰
        warmDeep: "#EA580C", // æš–æ©˜ï¼ˆæ·±è‰²ï¼‰
        warmBright: "#F97316", // æš–æ©˜ï¼ˆäº®è‰²ï¼‰
        titleDark: "#1E293B", // æ·±ç°ï¼ˆæ¨™é¡Œç”¨ï¼‰
        background: "#f0faf9", // é é¢èƒŒæ™¯ï¼ˆæ•™è‚²ç§‘æŠ€æ„Ÿè–„è·ç¶ åº•ï¼‰
        card: "#FFFFFF", // å¡ç‰‡ç™½
        success: "#10B981", // æˆåŠŸç¶ 
      };

      /* ------------------------------------------
       * é€²åº¦ç«™é»è¨­å®š
       * ------------------------------------------ */
      const STAGES = [
        { id: 1, label: "ç¬¬ä¸€ç«™" },
        { id: 2, label: "ç¬¬äºŒç«™" },
        { id: 3, label: "ç¬¬ä¸‰ç«™" },
      ];

      /* ------------------------------------------
       * è·å ´èƒ½åŠ›è³‡æ–™ï¼ˆå…­é …æŒ‡æ¨™ï¼‰
       * æ¯é …åŒ…å«ï¼šä¼æ¥­å®šç¾© (corpDef) èˆ‡æ°¸é½¡å¯¦ä½œå®šç¾© (ylDef)
       * ------------------------------------------ */
      const SKILLS = [
        {
          id: "communication",
          name: "æºé€šåŠ›",
          icon: "ğŸ’¬",
          corpDef: "æœ‰æ•ˆå‚³éè³‡è¨Šä¸¦é”æˆå…±è­˜ã€‚",
          ylDef: "èƒ½å¼•å°ä¸åŒèƒŒæ™¯çš„å­¸ç«¥é€²è¡Œæƒ…ç·’è¡¨é”èˆ‡è¡çªèª¿è§£ã€‚",
          color: "blue",
        },
        {
          id: "leadership",
          name: "é ˜å°åŠ›",
          icon: "ğŸ¯",
          corpDef: "å¸¶é ˜åœ˜éšŠé”æˆç›®æ¨™ï¼Œæ¿€ç™¼æˆå“¡æ½›èƒ½ã€‚",
          ylDef: "èƒ½åœ¨æ··é½¡ç’°å¢ƒä¸­å®‰æ’å°çµ„ä»»å‹™ä¸¦æ¿€å‹µå­¸ç«¥åƒèˆ‡ã€‚",
          color: "purple",
        },
        {
          id: "problem-solving",
          name: "å•é¡Œè§£æ±º",
          icon: "ğŸ§©",
          corpDef: "åˆ†æå•é¡Œæ ¹å› ä¸¦æå‡ºæœ‰æ•ˆè§£æ±ºæ–¹æ¡ˆã€‚",
          ylDef: "èƒ½å› æ‡‰èª²å ‚çªç™¼ç‹€æ³å³æ™‚èª¿æ•´æ•™å­¸ç­–ç•¥ã€‚",
          color: "green",
        },
        {
          id: "teamwork",
          name: "åœ˜éšŠåˆä½œ",
          icon: "ğŸ¤",
          corpDef: "èˆ‡ä»–äººå”ä½œå®Œæˆå…±åŒç›®æ¨™ã€‚",
          ylDef: "èƒ½èˆ‡ç­å°å¸«ã€å®¶é•·åŠå…¶ä»–å¿—å·¥æœ‰æ•ˆå”èª¿é…åˆã€‚",
          color: "pink",
        },
        {
          id: "resilience",
          name: "éŸŒæ€§",
          icon: "ğŸ’ª",
          corpDef: "é¢å°æŒ«æŠ˜èƒ½å¿«é€Ÿèª¿é©ä¸¦æŒçºŒå‰é€²ã€‚",
          ylDef: "é¢å°å­¸ç«¥æƒ…ç·’çˆ†ç™¼æˆ–æ•™å­¸æŒ«æŠ˜ï¼Œèƒ½èª¿æ•´å¿ƒæ…‹ç¹¼çºŒæŠ•å…¥ã€‚",
          color: "orange",
        },
        {
          id: "empathy",
          name: "åŒç†å¿ƒ",
          icon: "â¤ï¸",
          corpDef: "ç†è§£ä»–äººæ„Ÿå—ä¸¦åšå‡ºé©ç•¶å›æ‡‰ã€‚",
          ylDef: "èƒ½æ„ŸçŸ¥å­¸ç«¥æƒ…ç·’è®ŠåŒ–ï¼Œç”¨é©é½¡çš„æ–¹å¼çµ¦äºˆæ”¯æŒã€‚",
          color: "red",
        },
      ];

      /* ------------------------------------------
       * æ¯å€‹èƒ½åŠ›å°æ‡‰çš„è‰²ç³»ï¼ˆTailwind class ç”¨ï¼‰
       * ------------------------------------------ */
      const SKILL_COLOR_MAP = {
        blue: { bg: "#E0F2F1", border: "#00897B", text: "#00695C" },
        purple: { bg: "#F5F3FF", border: "#8B5CF6", text: "#6D28D9" },
        green: { bg: "#ECFDF5", border: "#10B981", text: "#047857" },
        pink: { bg: "#FDF2F8", border: "#EC4899", text: "#BE185D" },
        orange: { bg: "#FFF7ED", border: "#F97316", text: "#C2410C" },
        red: { bg: "#FEF2F2", border: "#EF4444", text: "#B91C1C" },
      };

      /* ------------------------------------------
       * é›·é”åœ–è³‡æ–™å¸¸æ•¸ï¼ˆäº”é …èƒ½åŠ›å€¼ + è¡Œç‚ºè­‰è·¡ï¼‰
       * ------------------------------------------ */
      const RADAR_SKILLS = ["æºé€šåŠ›", "å•é¡Œè§£æ±º", "éŸŒæ€§", "åŒç†å¿ƒ", "é ˜å°åŠ›"];

      // äº”å€‹æˆé•·éšæ®µï¼ˆå–ä»£åˆ†æ•¸åˆ¶ï¼‰
      const STAGE_LABELS = ["è¦ºå¯ŸæœŸ", "å˜—è©¦æœŸ", "æ‡‰ç”¨æœŸ", "ç©©å®šæœŸ", "èªè­‰ç´š"];

      // æ¯é …èƒ½åŠ›ç›®å‰æ‰€è™•çš„éšæ®µï¼ˆ1-5ï¼‰
      const RADAR_VALUES = [4, 5, 4, 3, 3];

      // è¡Œç‚ºè­‰è·¡ï¼šæ¯é …èƒ½åŠ›å°æ‡‰çš„å…·é«”äº‹ä»¶ + æ‰€è™•éšæ®µèªªæ˜
      const RADAR_EVIDENCE = {
        æºé€šåŠ›: {
          week: 5,
          stage: 4,
          title: "å¼•å°å­¸ç«¥è¡¨é”æƒ…ç·’",
          desc: "æˆåŠŸå¼•å°å°æ˜ç”¨èªè¨€æè¿°è‡ªå·±çš„æ„Ÿå—ï¼Œé¿å…è‚¢é«”è¡çªã€‚",
          stageNote: "å·²èƒ½åœ¨çœŸå¯¦è¡çªä¸­ç©©å®šé‹ç”¨æºé€šæŠ€å·§ï¼Œå¤šæ¬¡å±•ç¾ä¸€è‡´è¡¨ç¾ã€‚",
        },
        å•é¡Œè§£æ±º: {
          week: 10,
          stage: 5,
          title: "çªç™¼ç‹€æ³è™•ç†",
          desc: "èª²å ‚æŠ•å½±æ©Ÿæ•…éšœæ™‚ï¼Œå³æ™‚æ”¹ç”¨åˆ†çµ„è¨è«–æ´»å‹•å¡«è£œç©ºç™½ã€‚",
          stageNote: "é¢å°çªç™¼ç‹€æ³èƒ½å³æ™‚æ‡‰è®Šï¼Œå±•ç¾æ¥­ç•Œèªå¯çš„å•é¡Œè§£æ±ºæ°´æº–ã€‚",
        },
        éŸŒæ€§: {
          week: 8,
          stage: 4,
          title: "è¡çªè™•ç†å›è¦†",
          desc: "é¢å°å…©ä½å­¸ç«¥æ¿€çƒˆè¡çªï¼Œè€å¿ƒå¼•å°é›™æ–¹å†·éœä¸¦é”æˆå’Œè§£ã€‚",
          stageNote: "å¤šæ¬¡åœ¨é«˜å£“æƒ…å¢ƒä¸‹ç¶­æŒç©©å®šï¼Œå·²æˆç‚ºå¯é æœŸçš„è¡Œç‚ºæ¨¡å¼ã€‚",
        },
        åŒç†å¿ƒ: {
          week: 12,
          stage: 3,
          title: "å¯Ÿè¦ºå­¸ç«¥æƒ…ç·’è®ŠåŒ–",
          desc: "æ³¨æ„åˆ°å°è¯é€£çºŒå…©å¤©æ²‰é»˜ï¼Œä¸»å‹•é—œå¿ƒå¾Œç™¼ç¾å®¶åº­å•é¡Œã€‚",
          stageNote: "èƒ½åœ¨çœŸå¯¦æƒ…å¢ƒä¸­ä¸»å‹•è§€å¯Ÿä¸¦å›æ‡‰ä»–äººæƒ…ç·’ï¼Œæœ‰å…·é«”æ¡ˆä¾‹ä½è­‰ã€‚",
        },
        é ˜å°åŠ›: {
          week: 15,
          stage: 3,
          title: "å¸¶é ˜å°çµ„å®Œæˆä»»å‹™",
          desc: "æŒ‡å°å››äººå°çµ„å®Œæˆç’°ä¿ä¸»é¡Œæµ·å ±ï¼Œæ¯ä½çµ„å“¡éƒ½æœ‰è²¢ç»ã€‚",
          stageNote: "é–‹å§‹åœ¨å°çµ„æƒ…å¢ƒä¸­å±•ç¾é ˜å°è¡Œç‚ºï¼Œèƒ½åˆ†é…ä»»å‹™ä¸¦é¼“å‹µåƒèˆ‡ã€‚",
        },
      };

      /* ------------------------------------------
       * TopNav å…ƒä»¶ï¼šé ‚éƒ¨å°è¦½åˆ—
       * - å›ºå®šåœ¨é é¢æœ€ä¸Šæ–¹
       * - åŒ…å«è¿”å›é¦–é é€£çµã€é€²åº¦æŒ‡ç¤ºå™¨ã€æ¨™é¡Œ
       * ------------------------------------------ */
      function TopNav({ currentStage, onStageClick }) {
        // ç•¶ currentStage === 4ï¼ˆè­‰æ›¸é ï¼‰ï¼Œé€²åº¦åˆ—è¦–ç‚ºç¬¬ 3 ç«™å®Œæˆï¼Œå…¨éƒ¨é¡¯ç¤ºå®Œæˆ
        const displayStage = currentStage === 4 ? 4 : currentStage;

        return (
          <nav
            className="sticky top-0 z-50 shadow-md"
            style={{
              /* 3 è‰²æ·±â†’ä¸­â†’æ·ºæ¼¸å±¤ï¼Œå¢åŠ æ·±åº¦æ„Ÿ */
              background:
                "linear-gradient(135deg, #004D40 0%, #00695C 50%, #00897B 100%)",
              /* åœ“é»ç¶²æ ¼ç´‹ç†ç–ŠåŠ åœ¨æ¼¸å±¤ä¹‹ä¸Šï¼ˆå¤šé‡èƒŒæ™¯èªæ³•ï¼‰ */
              backgroundImage:
                "radial-gradient(rgba(255, 255, 255, 0.08) 1px, transparent 1px), linear-gradient(135deg, #004D40 0%, #00695C 50%, #00897B 100%)",
              backgroundSize: "20px 20px, 100% 100%",
              borderBottom: "1px solid rgba(0, 77, 64, 0.4)",
            }}
          >
            <div className="max-w-6xl mx-auto px-4 py-3 flex items-center justify-between">
              {/* å·¦å´ï¼šè¿”å›é¦–é  */}
              <a
                href="index.html"
                className="flex items-center gap-1 text-sm font-medium hover:opacity-70 transition-opacity"
                style={{ color: "rgba(255, 255, 255, 0.9)" }}
              >
                <span>â†</span>
                <span>å›åˆ°é¦–é </span>
              </a>

              {/* ä¸­é–“ï¼šé€²åº¦æŒ‡ç¤ºå™¨ */}
              <div className="flex items-center gap-1">
                {STAGES.map((stage, index) => {
                  // ç•¶åœ¨ç¬¬ 4 ç«™ï¼ˆè­‰æ›¸é ï¼‰ï¼Œæ‰€æœ‰ 3 ç«™éƒ½é¡¯ç¤ºç‚ºå·²å®Œæˆï¼ˆä¸é¡¯ç¤º currentï¼‰
                  const isCompleted =
                    displayStage === 4 ? true : stage.id < currentStage;
                  const isCurrent =
                    displayStage === 4 ? false : stage.id === currentStage;
                  const isPending =
                    displayStage === 4 ? false : stage.id > currentStage;

                  return (
                    <React.Fragment key={stage.id}>
                      {/* åœ“é»å’Œæ¨™ç±¤çš„å®¹å™¨ */}
                      <div className="flex flex-col items-center">
                        {/* åœ“é»ï¼šå¯é»æ“Šåˆ‡æ›éšæ®µ */}
                        <button
                          onClick={() => onStageClick(stage.id)}
                          className={`
                            w-8 h-8 rounded-full flex items-center justify-center
                            text-xs font-bold transition-all duration-300 cursor-pointer
                            ${isCurrent ? "animate-pulse-dot" : ""}
                          `}
                          style={{
                            backgroundColor:
                              isCurrent || isCompleted
                                ? "rgba(255,255,255,0.25)"
                                : "transparent",
                            color: "#FFFFFF",
                            border: isPending
                              ? "2px solid rgba(255,255,255,0.35)"
                              : "2px solid rgba(255,255,255,0.8)",
                            fontFamily: '"Inter", "Noto Sans TC", sans-serif',
                          }}
                        >
                          {/* å·²å®Œæˆé¡¯ç¤ºå‹¾å‹¾ï¼Œå…¶é¤˜é¡¯ç¤ºæ•¸å­— */}
                          {isCompleted ? "âœ“" : stage.id}
                        </button>

                        {/* åœ“é»ä¸‹æ–¹çš„ç«™åæ¨™ç±¤ */}
                        <span
                          className="text-xs mt-1 whitespace-nowrap"
                          style={{
                            color: isCurrent
                              ? "#FFFFFF"
                              : isCompleted
                                ? "rgba(255,255,255,0.85)"
                                : "rgba(255,255,255,0.5)",
                            fontWeight: isCurrent ? 600 : 400,
                          }}
                        >
                          {stage.label}
                        </span>
                      </div>

                      {/* åœ“é»ä¹‹é–“çš„é€£æ¥ç·šï¼ˆæœ€å¾Œä¸€å€‹ä¸éœ€è¦ï¼‰ */}
                      {index < STAGES.length - 1 && (
                        <div
                          className="h-0.5 rounded-full transition-all duration-500"
                          style={{
                            width: "40px",
                            backgroundColor:
                              stage.id < currentStage
                                ? "rgba(255,255,255,0.8)"
                                : "rgba(255,255,255,0.25)",
                            marginBottom: "18px", // å°é½Šåœ“é»ä¸­å¿ƒï¼ˆæ‰£æ‰ä¸‹æ–¹æ¨™ç±¤é«˜åº¦ï¼‰
                          }}
                        />
                      )}
                    </React.Fragment>
                  );
                })}
              </div>

              {/* å³å´ï¼šé é¢æ¨™é¡Œ */}
              <span
                className="text-sm font-semibold hidden sm:block"
                style={{
                  color: "rgba(255, 255, 255, 0.9)",
                  fontFamily: '"Inter", "Noto Sans TC", sans-serif',
                }}
              >
                æ°¸çºŒå¿—å·¥æ•¸æ“šé£›è¼ª
              </span>
            </div>
          </nav>
        );
      }

      /* ------------------------------------------
       * Stage1 å…ƒä»¶ï¼šç¬¬ä¸€ç«™ â€” è·å ´æŒ‡æ¨™å°æ¨™
       * - é¡¯ç¤ºå…­å¼µèƒ½åŠ›å¡ç‰‡ï¼ˆ2x3 gridï¼‰
       * - é»æ“Šå¡ç‰‡å±•é–‹ä¼æ¥­å®šç¾© & æ°¸é½¡å¯¦ä½œ
       * - é»éã€Œæºé€šåŠ›ã€å¾Œé¡¯ç¤ºå‰é€²æŒ‰éˆ•
       * ------------------------------------------ */
      function Stage1({ onNext }) {
        // ç›®å‰é¸ä¸­çš„å¡ç‰‡ idï¼ˆnull è¡¨ç¤ºæ²’é¸ï¼‰
        const [selectedSkill, setSelectedSkill] = useState(null);
        // æ˜¯å¦æ›¾é»æ“Šéã€Œæºé€šåŠ›ã€ï¼Œé»éæ‰é¡¯ç¤ºå‰é€²æŒ‰éˆ•
        const [hasTappedComm, setHasTappedComm] = useState(false);

        /**
         * handleCardClickï¼šé»æ“Šå¡ç‰‡çš„è™•ç†
         * - å¦‚æœé»çš„æ˜¯å·²é¸ä¸­çš„å¡ç‰‡ â†’ æ”¶åˆï¼ˆè¨­ç‚º nullï¼‰
         * - å¦å‰‡å±•é–‹è©²å¡ç‰‡
         * - è‹¥é»åˆ°æºé€šåŠ›ï¼Œæ¨™è¨˜ hasTappedComm
         */
        const handleCardClick = useCallback((skillId) => {
          setSelectedSkill((prev) => (prev === skillId ? null : skillId));
          if (skillId === "communication") {
            setHasTappedComm(true);
          }
        }, []);

        return (
          <div className="max-w-3xl mx-auto px-4 py-10 stage-enter">
            {/* æ¨™é¡Œå€åŸŸ */}
            <div className="text-center mb-8">
              <h1
                className="text-3xl md:text-4xl font-bold mb-3"
                style={{ color: COLORS.titleDark }}
              >
                ğŸ¢ æ°¸é½¡è·å ´åŠ›å­—å…¸
              </h1>
              <p className="text-base" style={{ color: "#64748B" }}>
                é»æ“Šä»»ä¸€èƒ½åŠ›ï¼Œçœ‹çœ‹ä¼æ¥­æ€éº¼å®šç¾©ï¼Œæ°¸é½¡æ€éº¼å¯¦è¸
              </p>
            </div>

            {/* 2x3 èƒ½åŠ›å¡ç‰‡ grid */}
            <div className="grid grid-cols-2 md:grid-cols-3 gap-4">
              {SKILLS.map((skill, index) => {
                const isSelected = selectedSkill === skill.id;
                const colors = SKILL_COLOR_MAP[skill.color];

                return (
                  <div
                    key={skill.id}
                    onClick={() => handleCardClick(skill.id)}
                    className="rounded-xl cursor-pointer select-none animate-fade-in-up"
                    style={{
                      /* å‹•ç•«å»¶é²ï¼šå¡ç‰‡é€ä¸€æµ®ç¾ */
                      animationDelay: `${index * 0.08}s`,
                      background: isSelected
                        ? colors.bg
                        : "rgba(255,255,255,0.85)",
                      border: isSelected
                        ? `2px solid ${colors.border}`
                        : "2px solid transparent",
                      boxShadow: isSelected
                        ? `0 4px 20px ${colors.border}33`
                        : "0 1px 4px rgba(0,0,0,0.06)",
                      /* ç”¨ transition åšå¹³æ»‘å±•é–‹/æ”¶åˆ + hover æµ®èµ· */
                      transition: "all 0.3s cubic-bezier(0.22, 1, 0.36, 1)",
                      transform: isSelected
                        ? "translateY(-2px)"
                        : "translateY(0)",
                      padding: "20px",
                    }}
                    onMouseEnter={(e) => {
                      if (!isSelected) {
                        e.currentTarget.style.transform = "translateY(-4px)";
                        e.currentTarget.style.boxShadow =
                          "0 6px 16px rgba(0,0,0,0.1)";
                      }
                    }}
                    onMouseLeave={(e) => {
                      if (!isSelected) {
                        e.currentTarget.style.transform = "translateY(0)";
                        e.currentTarget.style.boxShadow =
                          "0 1px 4px rgba(0,0,0,0.06)";
                      }
                    }}
                  >
                    {/* å¡ç‰‡ä¸Šæ–¹ï¼šåœ–ç¤º + èƒ½åŠ›åç¨± */}
                    <div className="flex items-center gap-2 mb-1">
                      <span className="text-2xl">{skill.icon}</span>
                      <span
                        className="text-base font-semibold"
                        style={{
                          color: isSelected ? colors.text : COLORS.titleDark,
                        }}
                      >
                        {skill.name}
                      </span>
                    </div>

                    {/* å±•é–‹å€åŸŸï¼šä¼æ¥­å®šç¾© + æ°¸é½¡å¯¦ä½œï¼ˆç”¨ max-height åšå¹³æ»‘å±•é–‹ï¼‰ */}
                    <div
                      style={{
                        maxHeight: isSelected ? "200px" : "0px",
                        opacity: isSelected ? 1 : 0,
                        overflow: "hidden",
                        transition:
                          "max-height 0.4s cubic-bezier(0.22, 1, 0.36, 1), opacity 0.3s ease",
                        marginTop: isSelected ? "12px" : "0px",
                      }}
                    >
                      {/* ä¼æ¥­å®šç¾© */}
                      <div className="mb-2">
                        <span
                          className="text-xs font-medium"
                          style={{ color: "#94A3B8" }}
                        >
                          ğŸ¢ ä¼æ¥­å®šç¾©
                        </span>
                        <p
                          className="text-sm mt-1"
                          style={{ color: COLORS.titleDark, lineHeight: "1.6" }}
                        >
                          {skill.corpDef}
                        </p>
                      </div>

                      {/* æ°¸é½¡å¯¦ä½œ */}
                      <div>
                        <span
                          className="text-xs font-medium"
                          style={{ color: "#94A3B8" }}
                        >
                          ğŸŒ± æ°¸é½¡å¯¦ä½œ
                        </span>
                        <p
                          className="text-sm mt-1"
                          style={{ color: COLORS.titleDark, lineHeight: "1.6" }}
                        >
                          {skill.ylDef}
                        </p>
                      </div>
                    </div>
                  </div>
                );
              })}
            </div>

            {/* å‰é€²æŒ‰éˆ•ï¼šé»éæºé€šåŠ›å¾Œæ‰é¡¯ç¤º */}
            {hasTappedComm && (
              <div
                className="flex justify-center mt-10 animate-fade-in-up"
                style={{ animationDelay: "0.1s" }}
              >
                <button
                  onClick={onNext}
                  className="px-8 py-3 rounded-full text-white font-semibold text-base
                             transition-all duration-300 cursor-pointer"
                  style={{
                    background:
                      "linear-gradient(135deg, #00897B 0%, #26A69A 100%)",
                    boxShadow: "0 2px 8px rgba(0, 137, 123, 0.2)",
                    fontFamily: '"Inter", "Noto Sans TC", sans-serif',
                  }}
                  onMouseEnter={(e) => {
                    e.currentTarget.style.transform = "translateY(-2px)";
                    e.currentTarget.style.boxShadow =
                      "0 6px 16px rgba(0, 137, 123, 0.35)";
                  }}
                  onMouseLeave={(e) => {
                    e.currentTarget.style.transform = "translateY(0)";
                    e.currentTarget.style.boxShadow =
                      "0 2px 8px rgba(0, 137, 123, 0.2)";
                  }}
                >
                  å‰å¾€ç¬¬äºŒç«™ â†’
                </button>
              </div>
            )}
          </div>
        );
      }

      /* ------------------------------------------
       * Stage2 å…ƒä»¶ï¼šç¬¬äºŒç«™ â€” AI æ·±åº¦å¼•å° & è¡Œç‚ºå®šç¾©
       *
       * å¤šè¼ªå°è©±æµç¨‹ï¼š
       *   1. AI è®€å–æ—¥èªŒ â†’ è­˜åˆ¥é—œéµè¡Œç‚ºæ¨™ç±¤
       *   2. AI é‡å°ã€Œæ±ºç­–é»ã€è¿½å• â†’ ç”¨æˆ¶é¸æ“‡ â†’ AI å‘½åç­–ç•¥
       *   3. AI é‡å°ã€Œå›é¥‹æ–¹å¼ã€è¿½å• â†’ ç”¨æˆ¶é¸æ“‡ â†’ AI å‘½åæŠ€å·§
       *   4. AI ç¶œåˆç”¢å‡ºã€Œèƒ½åŠ›å¿«ç…§ã€â†’ æˆé•·æŒ‡æ¨™ + æˆå°±å‹³ç« 
       *
       * step å°ç…§è¡¨ï¼š
       *   0: é é¢åˆå§‹          4: ç”¨æˆ¶ç­” Q1 + AI æ€è€ƒä¸­
       *   1: AI è½‰è­¯ä¸­         5: AI å›æ‡‰ 1 + å®šç¾©æ¡† + Q2
       *   2: è½‰è­¯å®Œæˆ/æ¨™ç±¤     6: ç”¨æˆ¶ç­” Q2 + AI æ€è€ƒä¸­
       *   3: Q1 å‡ºç¾           7: AI å›æ‡‰ 2 + å®šç¾©æ¡†
       *                        8: èƒ½åŠ›å¿«ç…§åˆæˆ
       *                        9: æŒ‡æ¨™ + å‹³ç«  + å‰é€²æŒ‰éˆ•
       * ------------------------------------------ */
      function Stage2({ onNext }) {
        // step æ§åˆ¶æ•´å€‹å°è©±é€²åº¦ï¼ˆè¦‹ä¸Šæ–¹å°ç…§è¡¨ï¼‰
        const [step, setStep] = useState(0);
        // è¨˜éŒ„å…©è¼ªå•ç­”ç”¨æˆ¶é¸äº†å“ªå€‹é¸é …ï¼ˆ0 æˆ– 1ï¼‰
        const [q1Pick, setQ1Pick] = useState(null);
        const [q2Pick, setQ2Pick] = useState(null);

        // æ”¶é›†æ‰€æœ‰ setTimeout idï¼Œå…ƒä»¶å¸è¼‰æ™‚çµ±ä¸€æ¸…é™¤
        const timersRef = useRef([]);
        // å°è©±å€åº•éƒ¨éŒ¨é»ï¼Œç”¨ä¾†è‡ªå‹•æ²å‹•
        const chatEndRef = useRef(null);

        // æ¯æ¬¡ step è®ŠåŒ– â†’ è‡ªå‹•æ²åˆ°å°è©±æœ€ä¸‹æ–¹
        useEffect(() => {
          if (chatEndRef.current) {
            chatEndRef.current.scrollIntoView({
              behavior: "smooth",
              block: "end",
            });
          }
        }, [step]);

        // === è‡ªå‹•è§¸ç™¼åºåˆ—ï¼šåˆå§‹åŒ– â†’ è½‰è­¯ â†’ æ¨™ç±¤ â†’ Q1 ===
        useEffect(() => {
          const t1 = setTimeout(() => setStep(1), 500);
          const t2 = setTimeout(() => setStep(2), 2500);
          const t3 = setTimeout(() => setStep(3), 3500);
          timersRef.current = [t1, t2, t3];
          return () => timersRef.current.forEach(clearTimeout);
        }, []);

        // Q1 å›ç­”ï¼šç”¨æˆ¶æ³¡æ³¡ â†’ AI æ€è€ƒ â†’ AI å›æ‡‰ + å®šç¾© + Q2
        const handleQ1 = useCallback((idx) => {
          setQ1Pick(idx);
          setStep(4);
          const t = setTimeout(() => setStep(5), 1500);
          timersRef.current.push(t);
        }, []);

        // Q2 å›ç­”ï¼šç”¨æˆ¶æ³¡æ³¡ â†’ AI æ€è€ƒ â†’ AI å›æ‡‰ + å®šç¾© â†’ åˆæˆ â†’ æŒ‡æ¨™
        const handleQ2 = useCallback((idx) => {
          setQ2Pick(idx);
          setStep(6);
          const t1 = setTimeout(() => setStep(7), 1500);
          const t2 = setTimeout(() => setStep(8), 3500);
          const t3 = setTimeout(() => setStep(9), 5500);
          timersRef.current.push(t1, t2, t3);
        }, []);

        /* === å°è©±è³‡æ–™ === */

        const TAGS = [
          { label: "âœ… è¡çªè§£æ±º", delay: "0s" },
          { label: "âœ… æƒ…ç·’ç®¡ç†", delay: "0.15s" },
          { label: "âœ… å¼•å°èƒ½åŠ›", delay: "0.3s" },
        ];

        // Q1ï¼šé‡å°ã€Œæ±ºç­–åˆ¤æ–·ã€è¿½å•
        const Q1 = {
          text: "æˆ‘æ³¨æ„åˆ°ä¸€å€‹é—œéµæ±ºç­–â€”â€”ä½ åœ¨è¡çªç•¶ä¸‹é¸æ“‡ã€Œå…ˆè®“ä»–å€‘å†·éœã€åˆ†é–‹åã€ï¼Œè€Œä¸æ˜¯é¦¬ä¸Šä»‹å…¥èª¿è§£ã€‚é€™å€‹åˆ¤æ–·å¾ˆé‡è¦ã€‚æ˜¯ä»€éº¼è®“ä½ åœ¨ç•¶ä¸‹åšå‡ºé€™å€‹é¸æ“‡ï¼Ÿ",
          options: [
            "ä»–å€‘æƒ…ç·’å¤ªæ¿€å‹•äº†ï¼Œæˆ‘è¦ºå¾—ç›´æ¥è¬›é“ç†ä¸€å®šè½ä¸é€²å»",
            "ä¹‹å‰è©¦éç›´æ¥å‹¸æ¶ä½†æ•ˆæœä¸å¥½ï¼Œé€™æ¬¡æƒ³å…ˆè®“ä»–å€‘é™æº«",
          ],
          responses: [
            "ä½ åœ¨æ²’æœ‰å—éå°ˆæ¥­è¨“ç·´çš„æƒ…æ³ä¸‹ï¼Œç›´è¦ºåšåˆ°äº†è¼”å°å·¥ä½œè€…çš„æ ¸å¿ƒåŸå‰‡â€”â€”å…ˆè™•ç†æƒ…ç·’ï¼Œå†è™•ç†å•é¡Œã€‚",
            "ä½ æ²’æœ‰ç›²ç›®é‡è¤‡éå»çš„åšæ³•ï¼Œè€Œæ˜¯å¾ç¶“é©—ä¸­ä¿®æ­£ç­–ç•¥ã€‚é€™ç¨®ã€Œåšäº†ã€åæ€ã€èª¿æ•´ã€çš„å¾ªç’°éå¸¸æœ‰åƒ¹å€¼ã€‚",
          ],
          definitions: [
            {
              term: "æƒ…ç·’å„ªå…ˆç­–ç•¥",
              en: "Emotion-First Approach",
              desc: "ç•¶äº‹äººè™•æ–¼é«˜æƒ…ç·’ç‹€æ…‹æ™‚ï¼Œç†æ€§æºé€šæ•ˆæœæ¥µä½ã€‚å°ˆæ¥­åšæ³•æ˜¯ï¼šå…ˆé™æº«ï¼ˆå†·éœï¼‰â†’ å†åˆ†é›¢ï¼ˆæ¸›å°‘åˆºæ¿€ï¼‰â†’ æœ€å¾Œå°è©±ï¼ˆç†æ€§è™•ç†ï¼‰ã€‚é˜¿æ˜ä»Šå¤©å®Œæ•´èµ°äº†é€™ä¸‰æ­¥ã€‚",
            },
            {
              term: "åæ€æ€§å¯¦è¸",
              en: "Reflective Practice",
              desc: "ä¸åªæ˜¯ã€Œåšã€ï¼Œè€Œæ˜¯ã€Œåš â†’ è§€å¯Ÿçµæœ â†’ èª¿æ•´åšæ³•ã€çš„å¾ªç’°ã€‚é€™æ˜¯è³‡æ·±ç¤¾å·¥èˆ‡æ–°æ‰‹æœ€å¤§çš„å·®ç•°â€”â€”èƒ½å¾æ¯æ¬¡æœå‹™ä¸­æŒçºŒå­¸ç¿’èˆ‡æ”¹é€²ã€‚",
            },
          ],
        };

        // Q2ï¼šé‡å°ã€Œå›é¥‹æ–¹å¼ã€è¿½å•
        const Q2 = {
          text: "æ¥ä¸‹ä¾†çœ‹å¦ä¸€å€‹é—œéµæ™‚åˆ»ï¼šå°æ˜å¾Œä¾†ä¸»å‹•å‘å°å¼·é“æ­‰äº†ã€‚åœ¨ä»–åšå‡ºé€™å€‹èˆ‰å‹•çš„å‰å¾Œï¼Œä½ æœ‰çµ¦ä»–ä»»ä½•å›é¥‹å—ï¼Ÿ",
          options: [
            "æˆ‘è·Ÿä»–èªªã€Œä½ é¡˜æ„é“æ­‰éœ€è¦å¾ˆå¤§çš„å‹‡æ°£ï¼Œè€å¸«è¦ºå¾—ä½ å¾ˆæ£’ã€",
            "æˆ‘æ²’æœ‰ç‰¹åˆ¥èªªä»€éº¼ï¼Œä½†æœ‰å°ä»–å¾®ç¬‘é»é ­",
          ],
          responses: [
            "ä½ çš„å›é¥‹æ–¹å¼æœ‰ä¸€å€‹äº®é»â€”â€”ä½ è‚¯å®šçš„æ˜¯ã€Œé“æ­‰çš„å‹‡æ°£ã€ï¼ˆéç¨‹ï¼‰ï¼Œè€Œä¸åªæ˜¯ã€Œæœ‰é“æ­‰ã€ï¼ˆçµæœï¼‰ã€‚é€™è®“å°æ˜çŸ¥é“è¢«çœ‹è¦‹çš„æ˜¯ä»–çš„åŠªåŠ›ã€‚",
            "æœ‰æ™‚å€™ä¸èªªè©±åè€Œæ˜¯æœ€å¥½çš„å›æ‡‰ã€‚ä½ ç”¨è‚¢é«”èªè¨€å‚³é”äº†æ¥ç´ï¼Œæ²’æœ‰è®“å›é¥‹è®Šæˆå£“åŠ›ï¼Œåè€Œçµ¦äº†å°æ˜è‡ªä¸»æˆé•·çš„ç©ºé–“ã€‚",
          ],
          definitions: [
            {
              term: "å…·é«”æ­£å‘å›é¥‹",
              en: "Specific Positive Feedback",
              desc: "ã€Œå¾ˆæ£’ã€æ˜¯æ¨¡ç³Šå›é¥‹ï¼›ã€Œä½ é¡˜æ„é“æ­‰éœ€è¦å‹‡æ°£ã€æ˜¯å…·é«”å›é¥‹ã€‚å…·é«”å›é¥‹è®“å°æ–¹æ˜ç¢ºçŸ¥é“ã€Œä»€éº¼è¡Œç‚ºè¢«çœ‹è¦‹äº†ã€ï¼Œæ›´æœ‰æ•ˆåœ°å¼·åŒ–æ­£å‘è¡Œç‚ºèˆ‡å…§åœ¨å‹•æ©Ÿã€‚",
            },
            {
              term: "éèªè¨€è‚¯å®š",
              en: "Non-verbal Affirmation",
              desc: "å¾®ç¬‘ã€é»é ­ã€çœ¼ç¥æ¥è§¸ç­‰éèªè¨€è¨Šè™Ÿï¼Œèƒ½åœ¨ä¸è£½é€ å£“åŠ›çš„æƒ…æ³ä¸‹å‚³é”ã€Œæˆ‘çœ‹è¦‹ä½ äº†ã€ã€‚å°é’å°‘å¹´ç‰¹åˆ¥æœ‰æ•ˆâ€”â€”ä»–å€‘æ•æ„Ÿæ–¼è¢«è©•åƒ¹ï¼Œä½†æ¸´æœ›è¢«çœ‹è¦‹ã€‚",
            },
          ],
        };

        /* === è¼”åŠ©æ¸²æŸ“å…ƒä»¶ === */

        function AiBubble({ children }) {
          return (
            <div className="flex justify-start mb-3 animate-fade-in">
              <div
                className="relative rounded-2xl px-4 py-3 chat-bubble-left"
                style={{
                  backgroundColor: COLORS.brandBright,
                  color: "#FFFFFF",
                  maxWidth: "92%",
                }}
              >
                <div className="text-sm leading-relaxed">{children}</div>
              </div>
            </div>
          );
        }

        function UserBubble({ text }) {
          return (
            <div className="flex justify-end mb-3 animate-fade-in">
              <div
                className="relative rounded-2xl px-4 py-3 chat-bubble-right"
                style={{
                  backgroundColor: COLORS.warmBright,
                  color: "#FFFFFF",
                  maxWidth: "85%",
                }}
              >
                <p className="text-sm leading-relaxed">{text}</p>
              </div>
            </div>
          );
        }

        function TypingDots() {
          return (
            <div className="flex justify-start mb-3 animate-fade-in">
              <div
                className="rounded-2xl px-4 py-3"
                style={{ backgroundColor: "#E0F2F1" }}
              >
                <div className="bouncing-dots">
                  <span></span>
                  <span></span>
                  <span></span>
                </div>
              </div>
            </div>
          );
        }

        function DefinitionCard({ term, en, desc }) {
          return (
            <div
              className="rounded-xl p-4 mb-3 animate-scale-in"
              style={{
                background: "linear-gradient(135deg, #EFF6FF 0%, #F0F9FF 100%)",
                border: "1px solid #BFDBFE",
              }}
            >
              <div className="flex items-start gap-2 mb-2">
                <span style={{ fontSize: "18px" }}>ğŸ’¡</span>
                <div>
                  <span
                    className="font-bold text-sm"
                    style={{ color: COLORS.brandDeep }}
                  >
                    {term}
                  </span>
                  <span className="text-xs ml-1.5" style={{ color: "#64748B" }}>
                    {en}
                  </span>
                </div>
              </div>
              <p
                className="text-xs leading-relaxed ml-7"
                style={{ color: "#475569" }}
              >
                {desc}
              </p>
            </div>
          );
        }

        function OptionGroup({ options, onSelect }) {
          return (
            <div
              className="flex flex-col gap-2 mb-3 animate-fade-in"
              style={{ animationDelay: "0.3s" }}
            >
              <p className="text-xs mb-1" style={{ color: "#94A3B8" }}>
                é¸æ“‡æœ€æ¥è¿‘ä½ çš„åšæ³•ï¼š
              </p>
              {options.map((text, idx) => (
                <button
                  key={idx}
                  onClick={() => onSelect(idx)}
                  className="text-left px-4 py-3 rounded-xl text-sm font-medium
                             transition-all duration-200 cursor-pointer"
                  style={{
                    border: `1.5px solid ${COLORS.brandBright}`,
                    color: COLORS.brandBright,
                    backgroundColor: "#FFFFFF",
                  }}
                  onMouseEnter={(e) => {
                    e.currentTarget.style.backgroundColor = "#E0F2F1";
                    e.currentTarget.style.transform = "translateX(4px)";
                  }}
                  onMouseLeave={(e) => {
                    e.currentTarget.style.backgroundColor = "#FFFFFF";
                    e.currentTarget.style.transform = "translateX(0)";
                  }}
                >
                  {text}
                </button>
              ))}
            </div>
          );
        }

        /* === ç•«é¢æ¸²æŸ“ === */
        return (
          <div className="max-w-5xl mx-auto px-4 py-8 stage-enter">
            <div className="flex flex-col lg:flex-row gap-8">
              {/* ====== å·¦å´ï¼šæ—¥èªŒ + è½‰è­¯ + èƒ½åŠ›å¿«ç…§ ====== */}
              <div className="lg:w-1/2">
                <h2
                  className="text-xl font-bold mb-1"
                  style={{ color: COLORS.titleDark }}
                >
                  ğŸ“ é˜¿æ˜çš„èª²å¾Œæ—¥èªŒ
                </h2>
                <p className="text-sm mb-4" style={{ color: "#94A3B8" }}>
                  ç¬¬ 8 é€± â€” 2026/02/18
                </p>

                {/* æ—¥èªŒå¡ç‰‡ */}
                <div
                  className="rounded-xl p-6 mb-4"
                  style={{ backgroundColor: "#FFFBEB" }}
                >
                  <p
                    className="text-base leading-relaxed"
                    style={{
                      color: "#78350F",
                      fontWeight: 300,
                      fontStyle: "italic",
                      lineHeight: "1.9",
                    }}
                  >
                    ä»Šå¤©å°æ˜è·Ÿå°å¼·åµæ¶ä¸å¯«åŠŸèª²ï¼Œæˆ‘å¾ˆå¿ƒç´¯ä½†é‚„æ˜¯å…ˆè®“ä»–å€‘å†·éœï¼Œåˆ†é–‹åä¹‹å¾Œè·Ÿä»–å€‘å€‹åˆ¥èŠäº†ä¸€ä¸‹ã€‚å°æ˜å¾Œä¾†æœ‰è·Ÿå°å¼·é“æ­‰ï¼Œé›–ç„¶èŠ±äº†å¾ˆå¤šæ™‚é–“ä½†çœ‹åˆ°ä»–å€‘å’Œå¥½è¦ºå¾—å¾ˆå€¼å¾—ã€‚
                  </p>
                </div>

                {/* AI è½‰è­¯ä¸­ */}
                {step === 1 && (
                  <div
                    className="flex items-center text-sm animate-fade-in"
                    style={{ color: COLORS.brandBright }}
                  >
                    <span>ğŸ”„ AI æ­£åœ¨è®€å–æ—¥èªŒ</span>
                    <div className="bouncing-dots">
                      <span></span>
                      <span></span>
                      <span></span>
                    </div>
                  </div>
                )}

                {/* è½‰è­¯çµæœæ¨™ç±¤ */}
                {step >= 2 && (
                  <div>
                    <p
                      className="text-xs mb-2 animate-fade-in"
                      style={{ color: "#94A3B8" }}
                    >
                      AI è­˜åˆ¥åˆ°ä»¥ä¸‹è¡Œç‚ºèƒ½åŠ›ï¼š
                    </p>
                    <div className="flex flex-wrap gap-2 animate-fade-in">
                      {TAGS.map((tag) => (
                        <span
                          key={tag.label}
                          className="inline-block px-3 py-1.5 rounded-full text-sm font-medium animate-scale-in"
                          style={{
                            backgroundColor: "#E0F2F1",
                            color: "#00695C",
                            animationDelay: tag.delay,
                          }}
                        >
                          {tag.label}
                        </span>
                      ))}
                    </div>
                  </div>
                )}

                {/* èƒ½åŠ›å¿«ç…§åˆæˆå¡ç‰‡ï¼ˆstep >= 8ï¼‰ */}
                {step >= 8 && (
                  <div
                    className="mt-6 rounded-xl p-5 animate-fade-in-up"
                    style={{
                      background:
                        "linear-gradient(135deg, #ECFDF5 0%, #F0FDFA 100%)",
                      border: "1.5px solid #A7F3D0",
                    }}
                  >
                    <h3
                      className="text-base font-bold mb-3"
                      style={{ color: COLORS.brandDeep }}
                    >
                      ğŸ¯ é˜¿æ˜çš„ä»Šæ—¥èƒ½åŠ›å¿«ç…§
                    </h3>
                    <div className="mb-3">
                      <p
                        className="text-xs font-semibold mb-1"
                        style={{ color: "#64748B" }}
                      >
                        è­˜åˆ¥èƒ½åŠ›
                      </p>
                      <div className="flex flex-wrap gap-1.5">
                        {["è¡çªè§£æ±º", "æƒ…ç·’ç®¡ç†", "å¼•å°èƒ½åŠ›"].map((s) => (
                          <span
                            key={s}
                            className="px-2.5 py-1 rounded-full text-xs font-medium"
                            style={{
                              backgroundColor: "#E0F2F1",
                              color: "#00695C",
                            }}
                          >
                            {s}
                          </span>
                        ))}
                      </div>
                    </div>
                    <div className="mb-3">
                      <p
                        className="text-xs font-semibold mb-1"
                        style={{ color: "#64748B" }}
                      >
                        å±•ç¾ç­–ç•¥
                      </p>
                      <div className="flex flex-wrap gap-1.5">
                        <span
                          className="px-2.5 py-1 rounded-full text-xs font-medium"
                          style={{
                            backgroundColor: "#DBEAFE",
                            color: "#1E40AF",
                          }}
                        >
                          {q1Pick !== null ? Q1.definitions[q1Pick].term : "â€”"}
                        </span>
                        <span
                          className="px-2.5 py-1 rounded-full text-xs font-medium"
                          style={{
                            backgroundColor: "#DBEAFE",
                            color: "#1E40AF",
                          }}
                        >
                          {q2Pick !== null ? Q2.definitions[q2Pick].term : "â€”"}
                        </span>
                      </div>
                    </div>
                    <div>
                      <p
                        className="text-xs font-semibold mb-1"
                        style={{ color: "#64748B" }}
                      >
                        åº•å±¤ç‰¹è³ª
                      </p>
                      <p className="text-xs" style={{ color: "#475569" }}>
                        åŒç†å¿ƒ Â· é©æ‡‰åŠ› Â· åæ€èƒ½åŠ›
                      </p>
                    </div>
                  </div>
                )}

                {/* æˆé•·æŒ‡æ¨™ + å‹³ç« ï¼ˆstep >= 9ï¼‰ */}
                {step >= 9 && (
                  <div className="mt-4 flex flex-col gap-2">
                    <div
                      className="rounded-xl px-4 py-3 animate-slide-in-right"
                      style={{
                        backgroundColor: "#FFF7ED",
                        border: "1px solid #FED7AA",
                      }}
                    >
                      <p
                        className="text-sm font-semibold"
                        style={{ color: "#C2410C" }}
                      >
                        ğŸ“ˆ éŸŒæ€§éšæ®µæå‡ï¼šå˜—è©¦æœŸ â†’ æ‡‰ç”¨æœŸ
                      </p>
                    </div>
                    <div
                      className="rounded-xl px-4 py-3 animate-scale-in"
                      style={{
                        backgroundColor: "#FFFBEB",
                        border: "2px solid #FCD34D",
                        animationDelay: "0.3s",
                      }}
                    >
                      <p
                        className="text-sm font-semibold"
                        style={{ color: "#92400E" }}
                      >
                        ğŸ… è§£é–æˆå°±ï¼šé€†å¢ƒèª¿é©è€…
                      </p>
                    </div>
                  </div>
                )}
              </div>

              {/* ====== å³å´ï¼šAI å¤šè¼ªå°è©±å€ ====== */}
              <div className="lg:w-1/2">
                <h2
                  className="text-xl font-bold mb-4"
                  style={{ color: COLORS.titleDark }}
                >
                  ğŸ¤– AI æˆé•·æ•™ç·´
                </h2>

                {/* å°è©±å®¹å™¨ï¼ˆå¯æ²å‹•ï¼‰ */}
                <div
                  className="rounded-xl p-4"
                  style={{
                    backgroundColor: "#F8FAFC",
                    maxHeight: "600px",
                    overflowY: "auto",
                  }}
                >
                  {/* â”€â”€ ç¬¬ä¸€è¼ªï¼šQ1 â”€â”€ */}
                  {step >= 3 && (
                    <AiBubble>
                      <p>é˜¿æ˜ï¼Œæˆ‘è®€å®Œä½ çš„æ—¥èªŒäº† ğŸ“–</p>
                      <p className="mt-2">{Q1.text}</p>
                    </AiBubble>
                  )}
                  {step === 3 && (
                    <OptionGroup options={Q1.options} onSelect={handleQ1} />
                  )}
                  {step >= 4 && q1Pick !== null && (
                    <UserBubble text={Q1.options[q1Pick]} />
                  )}
                  {step === 4 && <TypingDots />}

                  {/* AI å›æ‡‰ 1 + å°ˆæ¥­å®šç¾©æ¡† */}
                  {step >= 5 && q1Pick !== null && (
                    <>
                      <AiBubble>{Q1.responses[q1Pick]}</AiBubble>
                      <DefinitionCard {...Q1.definitions[q1Pick]} />
                    </>
                  )}

                  {/* â”€â”€ ç¬¬äºŒè¼ªï¼šQ2 â”€â”€ */}
                  {step >= 5 && <AiBubble>{Q2.text}</AiBubble>}
                  {step === 5 && (
                    <OptionGroup options={Q2.options} onSelect={handleQ2} />
                  )}
                  {step >= 6 && q2Pick !== null && (
                    <UserBubble text={Q2.options[q2Pick]} />
                  )}
                  {step === 6 && <TypingDots />}

                  {/* AI å›æ‡‰ 2 + å°ˆæ¥­å®šç¾©æ¡† */}
                  {step >= 7 && q2Pick !== null && (
                    <>
                      <AiBubble>{Q2.responses[q2Pick]}</AiBubble>
                      <DefinitionCard {...Q2.definitions[q2Pick]} />
                    </>
                  )}

                  {/* â”€â”€ AI ç¶œåˆçµèª â”€â”€ */}
                  {step >= 8 && (
                    <AiBubble>
                      <p>
                        âœ¨ é˜¿æ˜ï¼Œæˆ‘å¹«ä½ æ•´ç†å¥½äº†ã€Œä»Šæ—¥èƒ½åŠ›å¿«ç…§ã€â€”â€”ä½ ç”¨äº†
                        <strong>
                          ã€Œ{q1Pick !== null ? Q1.definitions[q1Pick].term : ""}
                          ã€
                        </strong>
                        è™•ç†è¡çªï¼Œå†ç”¨
                        <strong>
                          ã€Œ{q2Pick !== null ? Q2.definitions[q2Pick].term : ""}
                          ã€
                        </strong>
                        éå›ºé—œä¿‚ã€‚çœ‹å·¦é‚Šçš„å¿«ç…§ï¼Œä½ ä»Šå¤©çš„è¡¨ç¾å·²ç¶“è¢«è½‰åŒ–ç‚ºå¯è¿½è¹¤çš„è·å ´èƒ½åŠ›äº†ï¼
                      </p>
                    </AiBubble>
                  )}

                  {/* è‡ªå‹•æ²å‹•éŒ¨é» */}
                  <div ref={chatEndRef} />
                </div>
              </div>
            </div>

            {/* åº•éƒ¨å‰é€²æŒ‰éˆ• */}
            {step >= 9 && (
              <div
                className="flex justify-center mt-10 animate-fade-in-up"
                style={{ animationDelay: "0.2s" }}
              >
                <button
                  onClick={onNext}
                  className="px-8 py-3 rounded-full text-white font-semibold text-base
                             transition-all duration-300 cursor-pointer"
                  style={{
                    background:
                      "linear-gradient(135deg, #00897B 0%, #26A69A 100%)",
                    boxShadow: "0 2px 8px rgba(0, 137, 123, 0.2)",
                    fontFamily: '"Inter", "Noto Sans TC", sans-serif',
                  }}
                  onMouseEnter={(e) => {
                    e.currentTarget.style.transform = "translateY(-2px)";
                    e.currentTarget.style.boxShadow =
                      "0 6px 16px rgba(0, 137, 123, 0.35)";
                  }}
                  onMouseLeave={(e) => {
                    e.currentTarget.style.transform = "translateY(0)";
                    e.currentTarget.style.boxShadow =
                      "0 2px 8px rgba(0, 137, 123, 0.2)";
                  }}
                >
                  å‰å¾€ç¬¬ä¸‰ç«™ â†’
                </button>
              </div>
            )}
          </div>
        );
      }

      /* ------------------------------------------
       * RadarChart å…ƒä»¶ï¼šSVG é›·é”åœ–
       * - äº”è»¸èƒ½åŠ›é›·é”åœ–ï¼Œå¾ä¸­å¿ƒç¶»æ”¾å‹•ç•«
       * - å¯é»æ“Šé ‚é»æŸ¥çœ‹è¡Œç‚ºè­‰è·¡
       * Props:
       *   values: 5 å€‹æ•¸å€¼ï¼ˆ0-100ï¼‰
       *   labels: 5 å€‹èƒ½åŠ›åç¨±
       *   onVertexClick: é»æ“Šé ‚é»å›èª¿
       *   selectedVertex: ç•¶å‰é¸ä¸­çš„é ‚é»åç¨±
       *   size: SVG å°ºå¯¸ï¼ˆé è¨­ 300ï¼‰
       * ------------------------------------------ */
      function RadarChart({
        values,
        labels,
        onVertexClick,
        selectedVertex,
        size = 300,
      }) {
        // å‹•ç•«é€²åº¦ï¼ˆ0 â†’ 1ï¼‰ï¼Œæ§åˆ¶é›·é”åœ–å¾ä¸­å¿ƒç¶»æ”¾
        const [animationProgress, setAnimationProgress] = useState(0);
        // æ»‘é¼ æ‡¸åœçš„é ‚é»ç´¢å¼•
        const [hoveredIndex, setHoveredIndex] = useState(null);

        // é›·é”åœ–ä¸­å¿ƒé»èˆ‡æœ€å¤§åŠå¾‘
        const cx = 200;
        const cy = 200;
        const maxRadius = 120;
        const total = 5; // äº”è»¸

        /**
         * getPointï¼šè¨ˆç®—æ­£äº”é‚Šå½¢ä¸ŠæŸå€‹é ‚é»çš„åº§æ¨™
         * å¾æ­£ä¸Šæ–¹ï¼ˆ-PI/2ï¼‰é–‹å§‹é †æ™‚é‡æ’åˆ—
         */
        const getPoint = useCallback(
          (centerX, centerY, radius, index, count) => {
            const angle = (index / count) * 2 * Math.PI - Math.PI / 2;
            return {
              x: centerX + radius * Math.cos(angle),
              y: centerY + radius * Math.sin(angle),
            };
          },
          [],
        );

        /**
         * ç”Ÿæˆæ­£äº”é‚Šå½¢çš„ polygon points å­—ä¸²
         * ç”¨æ–¼èƒŒæ™¯åŒå¿ƒäº”é‚Šå½¢å’Œè³‡æ–™å¤šé‚Šå½¢
         */
        const buildPolygonPoints = useCallback(
          (centerX, centerY, radius, count) => {
            const points = [];
            for (let i = 0; i < count; i++) {
              const p = getPoint(centerX, centerY, radius, i, count);
              points.push(`${p.x},${p.y}`);
            }
            return points.join(" ");
          },
          [getPoint],
        );

        // === ç¶»æ”¾å‹•ç•«ï¼šä½¿ç”¨ requestAnimationFrame å¾ 0 æ¼¸é€²åˆ° 1 ===
        useEffect(() => {
          const duration = 1200; // 1.2 ç§’
          let startTime = null;
          let frameId = null;

          // easeOutCubic ç·©å‹•å‡½æ•¸ï¼šå¿«é€Ÿå±•é–‹ï¼Œå°¾ç«¯æ¸›é€Ÿ
          const easeOutCubic = (t) => 1 - Math.pow(1 - t, 3);

          const animate = (timestamp) => {
            if (startTime === null) startTime = timestamp;
            const elapsed = timestamp - startTime;
            const rawProgress = Math.min(elapsed / duration, 1);
            const easedProgress = easeOutCubic(rawProgress);

            setAnimationProgress(easedProgress);

            if (rawProgress < 1) {
              frameId = requestAnimationFrame(animate);
            }
          };

          frameId = requestAnimationFrame(animate);

          // æ¸…ç†ï¼šå…ƒä»¶å¸è¼‰æ™‚å–æ¶ˆå‹•ç•«
          return () => {
            if (frameId) cancelAnimationFrame(frameId);
          };
        }, []);

        // === è¨ˆç®—è³‡æ–™å¤šé‚Šå½¢çš„é ‚é»åº§æ¨™ï¼ˆéšæ®µ 1-5 â†’ æ¯”ä¾‹ 0.2-1.0ï¼‰ ===
        const maxStage = 5;
        const dataPoints = values.map((val, i) => {
          const radius = (val / maxStage) * maxRadius * animationProgress;
          return getPoint(cx, cy, radius, i, total);
        });
        const dataPolygonPoints = dataPoints
          .map((p) => `${p.x},${p.y}`)
          .join(" ");

        // === èƒŒæ™¯åŒå¿ƒäº”é‚Šå½¢ï¼ˆå°æ‡‰ 5 å€‹æˆé•·éšæ®µï¼‰ ===
        const bgLevels = [0.2, 0.4, 0.6, 0.8, 1.0];

        return (
          <svg
            viewBox="0 0 400 400"
            style={{ width: "100%", maxWidth: `${size}px`, height: "auto" }}
          >
            {/* SVG æ¿¾é¡å®šç¾©ï¼šåœ“é»å¾®ç™¼å…‰æ•ˆæœ */}
            <defs>
              <filter
                id="glow-teal"
                x="-50%"
                y="-50%"
                width="200%"
                height="200%"
              >
                <feGaussianBlur stdDeviation="2.5" result="blur" />
                <feMerge>
                  <feMergeNode in="blur" />
                  <feMergeNode in="SourceGraphic" />
                </feMerge>
              </filter>
              <filter
                id="glow-orange"
                x="-50%"
                y="-50%"
                width="200%"
                height="200%"
              >
                <feGaussianBlur stdDeviation="3" result="blur" />
                <feMerge>
                  <feMergeNode in="blur" />
                  <feMergeNode in="SourceGraphic" />
                </feMerge>
              </filter>
            </defs>

            {/* èƒŒæ™¯ï¼šå››å±¤åŒå¿ƒäº”é‚Šå½¢ */}
            {bgLevels.map((level, idx) => (
              <polygon
                key={`bg-${idx}`}
                points={buildPolygonPoints(cx, cy, maxRadius * level, total)}
                fill="none"
                stroke="#E2E8F0"
                strokeWidth="1"
                strokeDasharray={level < 1 ? "4 4" : "none"}
              />
            ))}

            {/* èƒŒæ™¯ï¼šäº”æ¢è»¸ç·šï¼ˆå¾ä¸­å¿ƒåˆ°å„é ‚é»ï¼‰ */}
            {Array.from({ length: total }).map((_, i) => {
              const endPoint = getPoint(cx, cy, maxRadius, i, total);
              return (
                <line
                  key={`axis-${i}`}
                  x1={cx}
                  y1={cy}
                  x2={endPoint.x}
                  y2={endPoint.y}
                  stroke="#E2E8F0"
                  strokeWidth="1"
                />
              );
            })}

            {/* è³‡æ–™å¤šé‚Šå½¢ï¼šå¸¶æœ‰å“ç‰Œé’ç¶ å¡«è‰²å’Œæé‚Š */}
            <polygon
              points={dataPolygonPoints}
              fill="rgba(0, 137, 123, 0.15)"
              stroke="#00897B"
              strokeWidth="2"
              strokeLinejoin="round"
            />

            {/* å„é ‚é»çš„äº’å‹•åœ“é» */}
            {dataPoints.map((point, i) => {
              const isSelected = selectedVertex === labels[i];
              const isHovered = hoveredIndex === i;
              const circleRadius = isSelected ? 8 : isHovered ? 7 : 6;

              return (
                <g key={`vertex-${i}`}>
                  {/* é¸ä¸­æ™‚çš„å…‰æšˆæ•ˆæœ */}
                  {isSelected && (
                    <circle
                      cx={point.x}
                      cy={point.y}
                      r="14"
                      fill="rgba(249, 115, 22, 0.2)"
                      stroke="none"
                    />
                  )}
                  {/* å¯é»æ“Šçš„é ‚é»åœ“é»ï¼ˆåŠ å…¥å¾®ç™¼å…‰ filterï¼‰ */}
                  <circle
                    cx={point.x}
                    cy={point.y}
                    r={circleRadius}
                    fill={isSelected ? "#F97316" : "#00897B"}
                    stroke="white"
                    strokeWidth="2"
                    filter={
                      isSelected ? "url(#glow-orange)" : "url(#glow-teal)"
                    }
                    style={{
                      cursor: "pointer",
                      transition: "r 0.2s ease, fill 0.2s ease",
                    }}
                    onClick={() => onVertexClick && onVertexClick(labels[i])}
                    onMouseEnter={() => setHoveredIndex(i)}
                    onMouseLeave={() => setHoveredIndex(null)}
                  />
                </g>
              );
            })}

            {/* å„é ‚é»çš„æ–‡å­—æ¨™ç±¤ï¼ˆä½æ–¼é›·é”åœ–å¤–åœˆï¼Œæ‹†é›™è¡Œé¿å…æˆªæ–·ï¼‰ */}
            {Array.from({ length: total }).map((_, i) => {
              // æ¨™ç±¤ä½ç½®ï¼šæœ€å¤§åŠå¾‘å†å¾€å¤–æ¨ 35px
              const labelPoint = getPoint(cx, cy, maxRadius + 35, i, total);
              const isSelected = selectedVertex === labels[i];

              return (
                <text
                  key={`label-${i}`}
                  x={labelPoint.x}
                  y={labelPoint.y}
                  textAnchor="middle"
                  dominantBaseline="middle"
                  fontSize="12"
                  fontWeight={isSelected ? "600" : "400"}
                  fill={isSelected ? "#F97316" : "#475569"}
                  style={{ cursor: "pointer" }}
                  onClick={() => onVertexClick && onVertexClick(labels[i])}
                >
                  <tspan x={labelPoint.x} dy="-0.4em">
                    {labels[i]}
                  </tspan>
                  <tspan
                    x={labelPoint.x}
                    dy="1.2em"
                    fontSize="10"
                    fill={isSelected ? "#F97316" : "#94A3B8"}
                  >
                    {STAGE_LABELS[values[i] - 1]}
                  </tspan>
                </text>
              );
            })}
          </svg>
        );
      }

      /* ------------------------------------------
       * Stage3 å…ƒä»¶ï¼šç¬¬ä¸‰ç«™ â€” SVG é›·é”åœ– + æ•¸ä½å±¥æ­·
       * - å·¦å´ï¼šäº”è»¸é›·é”èƒ½åŠ›åœ–
       * - å³å´ï¼šè¡Œç‚ºè­‰è·¡å¡ç‰‡ + æˆå°±æ‘˜è¦ + æ•¸æ“šäº®é»
       * - åº•éƒ¨ï¼šä¸‹è¼‰æ•¸ä½å±¥æ­·æŒ‰éˆ•
       * ------------------------------------------ */
      function Stage3({ onDownload, showToast }) {
        // ç•¶å‰é¸ä¸­çš„é›·é”åœ–é ‚é»ï¼ˆnull è¡¨ç¤ºæ²’é¸ï¼‰
        const [selectedVertex, setSelectedVertex] = useState(null);
        // æ˜¯å¦æ­£åœ¨ç”Ÿæˆæ•¸ä½å±¥æ­·ï¼ˆé¡¯ç¤º overlayï¼‰
        const [generating, setGenerating] = useState(false);
        // é€²åº¦æ–‡å­—ç´¢å¼•ï¼ˆ0, 1, 2ï¼‰
        const [progressTextIndex, setProgressTextIndex] = useState(0);

        // ç”Ÿæˆéç¨‹ä¸­çš„é€²åº¦æ–‡å­—
        const progressTexts = [
          "æ•´ç†èƒ½åŠ›æ•¸æ“š...",
          "åŒ¹é…è·å ´æ¨™æº–...",
          "ç”¢å‡ºèªè­‰å ±å‘Š...",
        ];

        // ç”Ÿæˆå‹•ç•«çš„è¨ˆæ™‚å™¨ï¼šæ¯ç§’åˆ‡æ›é€²åº¦æ–‡å­—ï¼Œ3 ç§’å¾Œè§¸ç™¼ onDownload
        useEffect(() => {
          if (!generating) return;

          // æ¯ç§’åˆ‡æ›é€²åº¦æ–‡å­—
          const textInterval = setInterval(() => {
            setProgressTextIndex((prev) => Math.min(prev + 1, 2));
          }, 1000);

          // 3 ç§’å¾Œè§¸ç™¼è·³è½‰åˆ°è­‰æ›¸é 
          const finishTimer = setTimeout(() => {
            setGenerating(false);
            onDownload();
          }, 3000);

          return () => {
            clearInterval(textInterval);
            clearTimeout(finishTimer);
          };
        }, [generating, onDownload]);

        /**
         * handleDownloadClickï¼šé»æ“Šä¸‹è¼‰æŒ‰éˆ•
         * ä¸ç›´æ¥è·³è½‰ï¼Œè€Œæ˜¯å…ˆé¡¯ç¤ºç”Ÿæˆ overlay
         */
        const handleDownloadClick = useCallback(() => {
          setGenerating(true);
          setProgressTextIndex(0);
        }, []);

        // å–å¾—é¸ä¸­é ‚é»å°æ‡‰çš„è¡Œç‚ºè­‰è·¡
        const evidence = selectedVertex ? RADAR_EVIDENCE[selectedVertex] : null;

        return (
          <div className="max-w-6xl mx-auto px-4 py-8 stage-enter">
            {/* === ç”Ÿæˆä¸­ Overlay === */}
            {generating && (
              <div
                className="fixed inset-0 z-50 flex items-center justify-center animate-fade-in"
                style={{
                  backgroundColor: "rgba(0, 0, 0, 0.5)",
                  backdropFilter: "blur(4px)",
                }}
              >
                <div
                  className="bg-white rounded-2xl p-8 shadow-2xl max-w-md w-full mx-4 text-center animate-scale-in"
                  style={{ animationDelay: "0s" }}
                >
                  {/* æ¨™é¡Œ */}
                  <h3
                    className="text-xl font-bold mb-6"
                    style={{ color: COLORS.titleDark }}
                  >
                    ğŸ”„ æ­£åœ¨ç”Ÿæˆæ‚¨çš„æ•¸ä½å±¥æ­·...
                  </h3>

                  {/* é€²åº¦æ¢è»Œé“ */}
                  <div
                    className="h-3 rounded-full mb-4"
                    style={{ backgroundColor: "#E5E7EB" }}
                  >
                    {/* é€²åº¦æ¢å¡«å……ï¼ˆ3 ç§’ç·šæ€§å‹•ç•«ï¼‰ */}
                    <div
                      className="h-3 rounded-full animate-generating-progress"
                      style={{
                        background: `linear-gradient(90deg, ${COLORS.brandDeep}, ${COLORS.brandBright})`,
                      }}
                    />
                  </div>

                  {/* å‹•æ…‹é€²åº¦æ–‡å­— */}
                  <p
                    className="text-sm font-medium"
                    style={{ color: "#64748B" }}
                  >
                    {progressTexts[progressTextIndex]}
                  </p>
                </div>
              </div>
            )}

            {/* é›™æ¬„å¸ƒå±€ï¼šå·¦å´é›·é”åœ–ã€å³å´æ•¸ä½å±¥æ­· */}
            <div className="flex flex-col lg:flex-row gap-8">
              {/* ====== å·¦å´ï¼šé›·é”èƒ½åŠ›åœ– ====== */}
              <div className="lg:w-3/5">
                <h2
                  className="text-2xl font-bold mb-4"
                  style={{ color: COLORS.titleDark }}
                >
                  ğŸ“Š é˜¿æ˜çš„ 18 é€±èƒ½åŠ›æˆé•·
                </h2>

                {/* é›·é”åœ–å…ƒä»¶ */}
                <div className="flex justify-center">
                  <RadarChart
                    values={RADAR_VALUES}
                    labels={RADAR_SKILLS}
                    onVertexClick={setSelectedVertex}
                    selectedVertex={selectedVertex}
                    size={360}
                  />
                </div>

                {/* æç¤ºæ–‡å­—ï¼šå°šæœªé¸æ“‡é ‚é»æ™‚é¡¯ç¤º */}
                {!selectedVertex && (
                  <p
                    className="text-center text-sm mt-2 animate-fade-in"
                    style={{ color: "#94A3B8" }}
                  >
                    ğŸ‘† é»æ“Šé›·é”åœ–ä¸Šçš„èƒ½åŠ›é ‚é»ï¼ŒæŸ¥çœ‹è¡Œç‚ºè­‰è·¡
                  </p>
                )}

                {/* éšæ®µå®šç¾©åœ–ä¾‹ */}
                <div
                  className="mt-6 rounded-xl p-4"
                  style={{
                    backgroundColor: "#F8FAFC",
                    border: "1px solid #E2E8F0",
                  }}
                >
                  <p
                    className="text-xs font-bold mb-3"
                    style={{ color: COLORS.titleDark }}
                  >
                    ğŸ“‹ æˆé•·éšæ®µå®šç¾©
                  </p>
                  <div className="space-y-2">
                    {[
                      {
                        stage: "èªè­‰ç´š",
                        color: COLORS.brandBright,
                        desc: "èƒ½åŠ›ç¶“å¤–éƒ¨è©•ä¼°é”æ¥­ç•Œæ¨™æº–ï¼Œå¯ç¨ç«‹æ‰¿æ“”å°ˆæ¥­ä»»å‹™",
                        basis: "ä¾æ“šï¼šé€šéæ©Ÿæ§‹èªè­‰è©•æ ¸æˆ–æ¥­ç•Œå°ˆå®¶è©•å®š",
                      },
                      {
                        stage: "ç©©å®šæœŸ",
                        color: "#26A69A",
                        desc: "åœ¨å¤šæ¬¡çœŸå¯¦æƒ…å¢ƒä¸­å±•ç¾ä¸€è‡´è¡¨ç¾ï¼Œå·²å…§åŒ–ç‚ºç¿’æ…£",
                        basis: "ä¾æ“šï¼š3 æ¬¡ä»¥ä¸Šä¸åŒæƒ…å¢ƒä¸­è§€å¯Ÿåˆ°ç›¸åŒè¡Œç‚ºæ¨¡å¼",
                      },
                      {
                        stage: "æ‡‰ç”¨æœŸ",
                        color: COLORS.warmBright,
                        desc: "èƒ½åœ¨çœŸå¯¦å ´æ™¯ä¸­ä¸»å‹•é‹ç”¨ï¼Œæœ‰å…·é«”æ¡ˆä¾‹ä½è­‰",
                        basis: "ä¾æ“šï¼šè‡³å°‘ 1 æ¬¡ç¨ç«‹æ‡‰ç”¨çš„è¡Œç‚ºç´€éŒ„",
                      },
                      {
                        stage: "å˜—è©¦æœŸ",
                        color: "#94A3B8",
                        desc: "é–‹å§‹åœ¨å¼•å°ä¸‹ç·´ç¿’ï¼Œå˜—è©¦æ‡‰ç”¨æ–¼ç°¡å–®æƒ…å¢ƒ",
                        basis: "ä¾æ“šï¼šæœ‰æ•™ç·´è§€å¯Ÿåˆ°çš„ç·´ç¿’è¡Œç‚ºç´€éŒ„",
                      },
                      {
                        stage: "è¦ºå¯ŸæœŸ",
                        color: "#CBD5E1",
                        desc: "èªè­˜åˆ°é€™é …èƒ½åŠ›çš„å­˜åœ¨ï¼Œé–‹å§‹è‡ªæˆ‘è¦ºå¯Ÿ",
                        basis: "ä¾æ“šï¼šè‡ªè©•å•å·æˆ–å°è©±ä¸­è¡¨é”å‡ºç›¸é—œæ„è­˜",
                      },
                    ].map((item) => (
                      <div key={item.stage} className="flex items-start gap-2">
                        <span
                          className="text-xs font-bold px-2 py-0.5 rounded-full shrink-0 mt-0.5"
                          style={{
                            color: "#fff",
                            backgroundColor: item.color,
                          }}
                        >
                          {item.stage}
                        </span>
                        <div>
                          <p
                            className="text-xs leading-relaxed"
                            style={{ color: "#475569" }}
                          >
                            {item.desc}
                          </p>
                          <p className="text-xs" style={{ color: "#94A3B8" }}>
                            {item.basis}
                          </p>
                        </div>
                      </div>
                    ))}
                  </div>
                </div>
              </div>

              {/* ====== å³å´ï¼šæ•¸ä½å±¥æ­·é è¦½ ====== */}
              <div className="lg:w-2/5 flex flex-col gap-4">
                <h2
                  className="text-2xl font-bold"
                  style={{ color: COLORS.titleDark }}
                >
                  ğŸ“„ æ•¸ä½å±¥æ­·é è¦½
                </h2>

                {/* è¡Œç‚ºè­‰è·¡å¡ç‰‡ï¼ˆé¸ä¸­é ‚é»å¾Œæ·¡å…¥é¡¯ç¤ºï¼‰ */}
                {evidence && (
                  <div
                    className="rounded-xl p-4 animate-fade-in"
                    style={{
                      backgroundColor: "#FFF7ED",
                      borderLeft: "4px solid #FB923C",
                    }}
                  >
                    <p
                      className="text-sm font-semibold mb-2"
                      style={{ color: "#C2410C" }}
                    >
                      ğŸ” è¡Œç‚ºè­‰è·¡
                    </p>
                    <p
                      className="text-sm font-bold mb-1"
                      style={{ color: COLORS.titleDark }}
                    >
                      ç¬¬ {evidence.week} é€± â€” {evidence.title}
                    </p>
                    <p
                      className="text-sm leading-relaxed mb-2"
                      style={{ color: "#64748B" }}
                    >
                      {evidence.desc}
                    </p>
                    <p
                      className="text-xs px-2.5 py-1 rounded-full inline-block font-medium"
                      style={{
                        backgroundColor: "#E0F2F1",
                        color: COLORS.brandDeep,
                      }}
                    >
                      ğŸ“ ç›®å‰éšæ®µï¼š{STAGE_LABELS[evidence.stage - 1]} â€”{" "}
                      {evidence.stageNote}
                    </p>
                  </div>
                )}

                {/* æˆå°±æ‘˜è¦å¡ç‰‡ */}
                <div
                  className="rounded-xl p-5 shadow-sm"
                  style={{ backgroundColor: COLORS.card }}
                >
                  <p
                    className="text-sm font-semibold mb-2"
                    style={{ color: COLORS.titleDark }}
                  >
                    ğŸ† æˆå°±æ‘˜è¦
                  </p>
                  <p
                    className="text-sm leading-relaxed"
                    style={{ color: "#64748B" }}
                  >
                    æœå‹™æœŸé–“å±•ç¾å“è¶ŠéŸŒæ€§ï¼Œè™•ç†è¶…é 10 æ¬¡ä»¥ä¸Šçªç™¼æƒ…ç·’å±æ©Ÿã€‚åœ¨ 18
                    é€±çš„æœå‹™æ­·ç¨‹ä¸­ï¼Œé˜¿æ˜å±•ç¾äº†é¡¯è‘—çš„å€‹äººæˆé•·è»Œè·¡ã€‚
                  </p>
                </div>

                {/* èƒ½åŠ›éšæ®µç¸½è¦½ï¼šä¸‰å¼µè¿·ä½ å¡ç‰‡ */}
                <div className="grid grid-cols-3 gap-3">
                  <div
                    className="rounded-xl p-3 text-center shadow-sm"
                    style={{ backgroundColor: COLORS.card }}
                  >
                    <p className="text-xs mb-1" style={{ color: "#94A3B8" }}>
                      å•é¡Œè§£æ±º
                    </p>
                    <p
                      className="text-sm font-bold"
                      style={{ color: COLORS.brandBright }}
                    >
                      â­ èªè­‰ç´š
                    </p>
                  </div>
                  <div
                    className="rounded-xl p-3 text-center shadow-sm"
                    style={{ backgroundColor: COLORS.card }}
                  >
                    <p className="text-xs mb-1" style={{ color: "#94A3B8" }}>
                      éŸŒæ€§
                    </p>
                    <p
                      className="text-sm font-bold"
                      style={{ color: COLORS.warmBright }}
                    >
                      ç©©å®šæœŸ
                    </p>
                  </div>
                  <div
                    className="rounded-xl p-3 text-center shadow-sm"
                    style={{ backgroundColor: COLORS.card }}
                  >
                    <p className="text-xs mb-1" style={{ color: "#94A3B8" }}>
                      åŒç†å¿ƒ
                    </p>
                    <p
                      className="text-sm font-bold"
                      style={{ color: COLORS.success }}
                    >
                      æ‡‰ç”¨æœŸ
                    </p>
                  </div>
                </div>
              </div>
            </div>

            {/* åº•éƒ¨ CTAï¼šä¸‹è¼‰æ•¸ä½å±¥æ­·æŒ‰éˆ•ï¼ˆé»æ“Šå¾Œå…ˆé¡¯ç¤ºç”Ÿæˆ overlayï¼‰ */}
            <div className="flex justify-center mt-10">
              <button
                onClick={handleDownloadClick}
                className="w-full max-w-xl px-8 py-4 rounded-xl text-white font-semibold text-lg
                           hover:shadow-lg transition-all duration-300 cursor-pointer"
                style={{
                  background: `linear-gradient(135deg, #EA580C, #F97316)`,
                }}
                onMouseEnter={(e) => {
                  e.currentTarget.style.transform = "translateY(-2px)";
                  e.currentTarget.style.filter = "brightness(0.95)";
                }}
                onMouseLeave={(e) => {
                  e.currentTarget.style.transform = "translateY(0)";
                  e.currentTarget.style.filter = "brightness(1)";
                }}
              >
                ğŸ“¥ ä¸‹è¼‰æ°¸çºŒèƒŒæ›¸ä¹‹è·å ´æ•¸ä½å±¥æ­·
              </button>
            </div>
          </div>
        );
      }

      /* ------------------------------------------
       * Toast å…ƒä»¶ï¼šå…¨åŸŸæç¤ºé€šçŸ¥
       * - å›ºå®šåœ¨é é¢åº•éƒ¨ä¸­å¤®
       * - æ·±ç°åº•ç™½å­—ï¼Œè‡ªå‹•æ·¡å…¥æ·¡å‡º
       * Props:
       *   message: é¡¯ç¤ºçš„è¨Šæ¯æ–‡å­—
       *   visible: æ˜¯å¦å¯è¦‹
       * ------------------------------------------ */
      function Toast({ message, visible }) {
        // æ§åˆ¶æ˜¯å¦çœŸæ­£æ¸²æŸ“ï¼ˆç”¨æ–¼æ·¡å‡ºå‹•ç•«çµæŸå¾Œæ‰ç§»é™¤ DOMï¼‰
        const [shouldRender, setShouldRender] = useState(false);
        // æ§åˆ¶å‹•ç•« classï¼ˆenter / exitï¼‰
        const [animClass, setAnimClass] = useState("");

        useEffect(() => {
          if (visible && message) {
            // é¡¯ç¤º toastï¼šç«‹å³æ¸²æŸ“ä¸¦æ’­æ”¾æ·¡å…¥å‹•ç•«
            setShouldRender(true);
            setAnimClass("toast-enter");
          } else if (shouldRender) {
            // éš±è— toastï¼šæ’­æ”¾æ·¡å‡ºå‹•ç•«ï¼Œ300ms å¾Œç§»é™¤ DOM
            setAnimClass("toast-exit");
            const timer = setTimeout(() => setShouldRender(false), 300);
            return () => clearTimeout(timer);
          }
        }, [visible, message]);

        if (!shouldRender) return null;

        return (
          <div
            className={`fixed bottom-8 z-50 ${animClass}`}
            style={{
              left: "50%",
            }}
          >
            <div
              className="px-6 py-3 rounded-lg shadow-lg"
              style={{
                backgroundColor: "#1F2937",
                color: "#FFFFFF",
                whiteSpace: "nowrap",
              }}
            >
              <p className="text-sm font-medium">{message}</p>
            </div>
          </div>
        );
      }

      /* ------------------------------------------
       * CertificateView å…ƒä»¶ï¼šç‹€æ…‹ 4 â€” æ•¸ä½èƒ½åŠ›èªè­‰æ›¸
       * - æ­£å¼è­‰æ›¸ç‰ˆé¢ï¼Œæ¨¡æ“¬ A4 è­‰æ›¸é¢¨æ ¼
       * - åŒ…å«é›·é”åœ–ã€æŠ€èƒ½é€²åº¦æ¢ã€è¡Œå‹•æŒ‰éˆ•
       * Props:
       *   onRestart: é‡æ–°é«”é©—çš„å›èª¿
       *   showToast: é¡¯ç¤º toast é€šçŸ¥çš„å‡½å¼
       * ------------------------------------------ */
      function CertificateView({ onRestart, showToast }) {
        // æ ¹æ“šéšæ®µå›å‚³é€²åº¦æ¢é¡è‰²
        const getStageColor = useCallback((stage) => {
          if (stage >= 5) return COLORS.brandBright; // èªè­‰ç´š
          if (stage >= 4) return "#26A69A"; // ç©©å®šæœŸ
          if (stage >= 3) return COLORS.warmBright; // æ‡‰ç”¨æœŸ
          return "#94A3B8"; // è¦ºå¯Ÿ/å˜—è©¦æœŸ
        }, []);

        return (
          <div className="max-w-3xl mx-auto px-4 py-10 stage-enter">
            {/* === è­‰æ›¸å¤–æ¡† === */}
            <div
              className="certificate-frame bg-white rounded-2xl shadow-2xl overflow-hidden"
              style={{ border: "2px solid #00796B" }}
            >
              {/* è§’è½è£é£¾ï¼šå·¦ä¸‹ã€å³ä¸‹ */}
              <span className="certificate-corner-bl">âœ¦</span>
              <span className="certificate-corner-br">âœ¦</span>

              {/* === A) é ‚éƒ¨ï¼šè­‰æ›¸æ¨™é ­ === */}
              <div
                className="text-center py-6 rounded-t-2xl"
                style={{
                  background: `linear-gradient(135deg, ${COLORS.brandDeep}, ${COLORS.brandBright})`,
                }}
              >
                <h1
                  className="text-2xl font-black tracking-wider text-white"
                  style={{ letterSpacing: "0.15em" }}
                >
                  æ•¸ä½èƒ½åŠ›èªè­‰æ¨™ç« 
                </h1>
              </div>

              {/* é‡‘è‰²è£é£¾ç·š */}
              <div
                className="h-1"
                style={{
                  background:
                    "linear-gradient(90deg, #FCD34D, #F59E0B, #D97706, #F59E0B, #FCD34D)",
                }}
              />

              {/* === B) å€‹äººè³‡è¨Šå€ === */}
              <div className="text-center py-8">
                {/* åœ“å½¢é ­åƒä½”ä½ */}
                <div
                  className="mx-auto mb-4 flex items-center justify-center rounded-full"
                  style={{
                    width: "80px",
                    height: "80px",
                    background: `linear-gradient(135deg, #26A69A, ${COLORS.brandDeep})`,
                  }}
                >
                  <span className="text-white font-bold text-lg">é˜¿æ˜</span>
                </div>

                {/* å§“å */}
                <h2
                  className="text-xl font-bold mb-1"
                  style={{ color: COLORS.titleDark }}
                >
                  å¿—å·¥ é™³é˜¿æ˜
                </h2>

                {/* æœå‹™æ‘˜è¦ */}
                <p className="text-sm" style={{ color: "#94A3B8" }}>
                  2025 å¹´ç§‹å­£å­¸æœŸ âˆ£ 18 é€±æœå‹™ âˆ£ ç´¯è¨ˆ 216 å°æ™‚
                </p>
              </div>

              {/* === C) æ ¸å¿ƒå€ï¼šè·å ´ç«¶çˆ­åŠ›å ±å‘Š === */}
              <div className="px-6 md:px-10 pb-8">
                {/* å ±å‘Šæ¨™é¡Œ */}
                <div className="text-center mb-6">
                  <h3
                    className="text-lg font-bold inline-block pb-1"
                    style={{
                      color: COLORS.titleDark,
                      borderBottom: `3px solid ${COLORS.brandBright}`,
                    }}
                  >
                    è·å ´ç«¶çˆ­åŠ›å ±å‘Š
                  </h3>
                </div>

                {/* é›™æ¬„ï¼šå·¦é›·é”åœ– + å³æŠ€èƒ½é€²åº¦æ¢ */}
                <div className="flex flex-col md:flex-row items-center gap-6">
                  {/* å·¦å´ï¼šå°å‹é›·é”åœ–ï¼ˆç„¡äº’å‹•ï¼‰ */}
                  <div className="flex-shrink-0">
                    <RadarChart
                      values={RADAR_VALUES}
                      labels={RADAR_SKILLS}
                      onVertexClick={() => {}}
                      selectedVertex={null}
                      size={200}
                    />
                  </div>

                  {/* å³å´ï¼šäº”é …æŠ€èƒ½é€²åº¦æ¢ */}
                  <div className="flex-1 w-full space-y-3">
                    {RADAR_SKILLS.map((skill, index) => {
                      const stage = RADAR_VALUES[index];
                      const barColor = getStageColor(stage);
                      const stageName = STAGE_LABELS[stage - 1];

                      return (
                        <div key={skill}>
                          {/* æŠ€èƒ½åç¨±å’Œéšæ®µæ¨™ç±¤ */}
                          <div className="flex justify-between items-center mb-1">
                            <span
                              className="text-sm font-medium"
                              style={{ color: COLORS.titleDark }}
                            >
                              {skill}
                            </span>
                            <span
                              className="text-xs font-bold px-2 py-0.5 rounded-full"
                              style={{
                                color: "#fff",
                                backgroundColor: barColor,
                              }}
                            >
                              {stageName}
                            </span>
                          </div>

                          {/* é€²åº¦æ¢è»Œé“ï¼ˆ5 æ ¼åˆ†æ®µï¼‰ */}
                          <div
                            className="h-2.5 rounded-full"
                            style={{ backgroundColor: "#E5E7EB" }}
                          >
                            {/* é€²åº¦æ¢å¡«å……ï¼šéšæ®µ / 5 æ›ç®—ç™¾åˆ†æ¯” */}
                            <div
                              className="h-2.5 rounded-full animate-progress-bar"
                              style={{
                                backgroundColor: barColor,
                                maxWidth: `${(stage / 5) * 100}%`,
                              }}
                            />
                          </div>
                        </div>
                      );
                    })}
                  </div>
                </div>

                {/* ç¶œåˆéšæ®µæ‘˜è¦ */}
                {(() => {
                  // è¨ˆç®—å„éšæ®µåˆ†å¸ƒ
                  const stageCounts = RADAR_VALUES.reduce((acc, v) => {
                    const name = STAGE_LABELS[v - 1];
                    acc[name] = (acc[name] || 0) + 1;
                    return acc;
                  }, {});
                  // æ‰¾å‡ºæœ€é«˜éšæ®µ
                  const maxStage = Math.max(...RADAR_VALUES);
                  const maxStageName = STAGE_LABELS[maxStage - 1];
                  // é”åˆ°ã€Œç©©å®šæœŸã€ä»¥ä¸Šçš„æŠ€èƒ½æ•¸
                  const stableCount = RADAR_VALUES.filter((v) => v >= 4).length;

                  return (
                    <div
                      className="text-center mt-6 py-3 rounded-lg"
                      style={{ backgroundColor: "#E0F2F1" }}
                    >
                      <p
                        className="text-sm font-semibold"
                        style={{
                          color: COLORS.brandDeep,
                          fontFamily: '"Inter", "Noto Sans TC", sans-serif',
                        }}
                      >
                        æœ€é«˜é”æˆï¼š{maxStageName} âˆ£ {stableCount}{" "}
                        é …æŠ€èƒ½å·²é”ç©©å®šæœŸä»¥ä¸Š
                      </p>
                    </div>
                  );
                })()}
              </div>

              {/* === D) è¡Œå‹•æŒ‰éˆ•å€ === */}
              <div className="flex gap-4 justify-center px-6 pb-8">
                {/* åˆ—å°æŒ‰éˆ•ï¼ˆå¤–æ¡†æ¨£å¼ï¼‰ */}
                <button
                  onClick={() => showToast("Demo æ¨¡å¼ï¼šåˆ—å°åŠŸèƒ½å³å°‡é–‹æ”¾")}
                  className="px-6 py-3 rounded-lg font-semibold text-sm transition-all duration-200 cursor-pointer"
                  style={{
                    border: `2px solid ${COLORS.brandBright}`,
                    color: COLORS.brandBright,
                    backgroundColor: "transparent",
                  }}
                  onMouseEnter={(e) => {
                    e.currentTarget.style.backgroundColor = "#E0F2F1";
                  }}
                  onMouseLeave={(e) => {
                    e.currentTarget.style.backgroundColor = "transparent";
                  }}
                >
                  ğŸ–¨ï¸ åˆ—å°æ­¤è­‰æ›¸
                </button>

                {/* åˆ†äº«æŒ‰éˆ•ï¼ˆå¡«è‰²æ¨£å¼ï¼‰ */}
                <button
                  onClick={() => showToast("Demo æ¨¡å¼ï¼šåˆ†äº«åŠŸèƒ½å³å°‡é–‹æ”¾")}
                  className="px-6 py-3 rounded-lg font-semibold text-sm text-white transition-all duration-200 cursor-pointer"
                  style={{ backgroundColor: COLORS.brandBright }}
                  onMouseEnter={(e) => {
                    e.currentTarget.style.backgroundColor = "#00796B";
                  }}
                  onMouseLeave={(e) => {
                    e.currentTarget.style.backgroundColor = COLORS.brandBright;
                  }}
                >
                  ğŸ”— åˆ†äº«è‡³ LinkedIn
                </button>
              </div>
            </div>

            {/* === E) é‡æ–°é«”é©—é€£çµ === */}
            <div className="text-center mt-6">
              <button
                onClick={onRestart}
                className="text-sm font-medium transition-opacity duration-200 hover:opacity-70 cursor-pointer"
                style={{
                  color: COLORS.brandBright,
                  background: "none",
                  border: "none",
                }}
              >
                â† é‡æ–°é«”é©—
              </button>
            </div>
          </div>
        );
      }

      /* ------------------------------------------
       * App å…ƒä»¶ï¼šä¸»æ‡‰ç”¨ç¨‹å¼
       * - ç®¡ç†ç•¶å‰ç«™é» (currentStage)
       * - ç®¡ç†è½‰å ´å‹•ç•« (stageTransition)
       * - ç®¡ç†å…¨åŸŸ toast é€šçŸ¥
       * ------------------------------------------ */
      function App() {
        // currentStage: 1~4ï¼ˆ1~3 ç‚ºä¸‰ç«™ï¼Œ4 ç‚ºè­‰æ›¸é ï¼‰
        const [currentStage, setCurrentStage] = useState(1);
        // stageTransition: true æ™‚è§¸ç™¼æ·¡å‡ºæ•ˆæœ
        const [stageTransition, setStageTransition] = useState(false);
        // toast ç›¸é—œç‹€æ…‹
        const [toastMessage, setToastMessage] = useState("");
        const [toastVisible, setToastVisible] = useState(false);
        // toast è¨ˆæ™‚å™¨ refï¼ˆé¿å…é‡è¤‡è¨ˆæ™‚ï¼‰
        const toastTimerRef = useRef(null);

        /**
         * showToastï¼šé¡¯ç¤ºå…¨åŸŸ toast é€šçŸ¥
         * è¨­å®šè¨Šæ¯ä¸¦åœ¨ 2 ç§’å¾Œè‡ªå‹•æ¸…é™¤
         */
        const showToast = useCallback((message) => {
          // æ¸…é™¤ä¹‹å‰çš„è¨ˆæ™‚å™¨ï¼ˆé¿å…é€£çºŒé»æ“Šæ™‚æå‰æ¶ˆå¤±ï¼‰
          if (toastTimerRef.current) {
            clearTimeout(toastTimerRef.current);
          }
          setToastMessage(message);
          setToastVisible(true);

          // 2 ç§’å¾Œè‡ªå‹•éš±è—
          toastTimerRef.current = setTimeout(() => {
            setToastVisible(false);
          }, 2000);
        }, []);

        /**
         * goToStageï¼šåˆ‡æ›ç«™é»çš„å‡½å¼
         * æµç¨‹ï¼šå…ˆæ·¡å‡ºï¼ˆ300msï¼‰â†’ åˆ‡æ›å…§å®¹ â†’ æ·¡å…¥
         */
        const goToStage = useCallback(
          (targetStage) => {
            // å¦‚æœç›®æ¨™å°±æ˜¯ç•¶å‰ç«™ï¼Œä¸åšä»»ä½•äº‹
            if (targetStage === currentStage) return;
            // é™åˆ¶ç¯„åœåœ¨ 1~4ï¼ˆç¬¬ 4 ç«™ç‚ºè­‰æ›¸é ï¼‰
            if (targetStage < 1 || targetStage > 4) return;

            // æ­¥é©Ÿ 1ï¼šè§¸ç™¼æ·¡å‡º
            setStageTransition(true);

            // æ­¥é©Ÿ 2ï¼šç­‰ 300ms å¾Œåˆ‡æ›ç«™é»ä¸¦ç§»é™¤è½‰å ´ç‹€æ…‹
            setTimeout(() => {
              setCurrentStage(targetStage);
              setStageTransition(false);
              // æ­¥é©Ÿ 3ï¼šåˆ‡æ›å¾Œè‡ªå‹•æ²åˆ°é ‚éƒ¨ï¼Œè®“ä½¿ç”¨è€…å¾é ­çœ‹èµ·
              window.scrollTo({ top: 0, behavior: "smooth" });
            }, 300);
          },
          [currentStage],
        );

        // æ‰¾åˆ°ç•¶å‰ç«™é»çš„æ¨™ç±¤æ–‡å­—
        const currentLabel =
          STAGES.find((s) => s.id === currentStage)?.label || "";

        return (
          <div
            className="min-h-screen"
            style={{
              background: COLORS.background,
              fontFamily: '"Noto Sans TC", sans-serif',
            }}
          >
            {/* é ‚éƒ¨å°è¦½åˆ— */}
            <TopNav currentStage={currentStage} onStageClick={goToStage} />

            {/* ä¸»è¦å…§å®¹å€åŸŸï¼ˆæ ¹æ“š currentStage æ¸²æŸ“å°æ‡‰å…ƒä»¶ï¼‰ */}
            <main
              className={`transition-opacity duration-300 ${
                stageTransition ? "opacity-0" : "opacity-100"
              }`}
            >
              {/* ç¬¬ä¸€ç«™ï¼šè·å ´æŒ‡æ¨™å°æ¨™ */}
              {currentStage === 1 && <Stage1 onNext={() => goToStage(2)} />}
              {/* ç¬¬äºŒç«™ï¼šè¡Œç‚ºè½‰è­¯ & AI è¿½å• */}
              {currentStage === 2 && <Stage2 onNext={() => goToStage(3)} />}
              {/* ç¬¬ä¸‰ç«™ï¼šSVG é›·é”åœ– + æ•¸ä½å±¥æ­·ï¼ˆå«ç”Ÿæˆ overlayï¼‰ */}
              {currentStage === 3 && (
                <Stage3 onDownload={() => goToStage(4)} showToast={showToast} />
              )}
              {/* ç¬¬å››ç«™ï¼šæ•¸ä½èƒ½åŠ›èªè­‰æ›¸ */}
              {currentStage === 4 && (
                <CertificateView
                  onRestart={() => goToStage(1)}
                  showToast={showToast}
                />
              )}
            </main>

            {/* å…¨åŸŸ Toast é€šçŸ¥ */}
            <Toast message={toastMessage} visible={toastVisible} />
          </div>
        );
      }

      /* ------------------------------------------
       * æ›è¼‰ React App åˆ° DOM
       * ------------------------------------------ */
      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  </body>
</html>
